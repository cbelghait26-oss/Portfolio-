<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusFlow - Goal-Oriented Productivity System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4A90E2;
            --primary-light: #E3F2FD;
            --secondary: #36B37E;
            --accent: #FFAB00;
            --danger: #FF5630;
            --text: #2E3A59;
            --text-light: #6C758F;
            --bg: #FFFFFF;
            --bg-secondary: #F8FAFC;
            --card: #FFFFFF;
            --shadow: rgba(0, 0, 0, 0.05);
            --border: #E2E8F0;
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --primary: #64B5F6;
            --primary-light: #1E293B;
            --secondary: #4DB6AC;
            --accent: #FFB74D;
            --danger: #FF8A80;
            --text: #E2E8F0;
            --text-light: #94A3B8;
            --bg: #0F172A;
            --bg-secondary: #1E293B;
            --card: #1E293B;
            --shadow: rgba(0, 0, 0, 0.3);
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Setup Modal */
        .setup-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }

        .setup-content {
            background: var(--card);
            border-radius: var(--radius);
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.5s ease;
        }

        .setup-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .setup-header i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .setup-header h2 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .setup-header p {
            color: var(--text-light);
        }

        .setup-step {
            animation: fadeIn 0.3s ease;
        }

        .setup-step.hidden {
            display: none;
        }

        .setup-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .setup-progress:before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border);
            z-index: 1;
        }

        .progress-step {
            position: relative;
            z-index: 2;
            text-align: center;
            width: 33.33%;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            font-weight: 600;
            transition: var(--transition);
        }

        .progress-step.active .step-circle {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .progress-step.completed .step-circle {
            background: var(--secondary);
            border-color: var(--secondary);
            color: white;
        }

        .setup-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo i {
            color: var(--primary);
            font-size: 28px;
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* Content Bar */
        .content-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .content-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Search Bar */
        .search-bar {
            position: relative;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .search-input {
            flex: 1;
            padding: 12px 45px 12px 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--card);
            color: var(--text);
            font-size: 16px;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .search-clear {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Quotes Bar */
        .quotes-bar {
            background: linear-gradient(135deg, var(--primary-light), transparent);
            border-left: 4px solid var(--primary);
            padding: 15px 20px;
            margin-bottom: 30px;
            border-radius: var(--radius);
            position: relative;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            animation: slideUp 0.5s ease;
        }

        .quote-content {
            flex: 1;
            padding-right: 20px;
        }

        .quote-text {
            font-size: 16px;
            font-style: italic;
            color: var(--text);
            margin-bottom: 5px;
            line-height: 1.5;
        }

        .quote-author {
            font-size: 14px;
            color: var(--text-light);
            font-weight: 500;
        }

        .quote-controls {
            display: flex;
            gap: 10px;
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 5px;
            background: var(--bg-secondary);
            padding: 8px;
            border-radius: var(--radius);
            margin-bottom: 30px;
            overflow-x: auto;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--text-light);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .nav-btn:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .nav-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: 0 4px 12px var(--shadow);
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Dashboard Grid - REORDERED */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .welcome-card {
            background: linear-gradient(135deg, var(--primary-light), transparent);
            border-left: 4px solid var(--primary);
            grid-column: 1 / -1;
        }

        .user-welcome {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 600;
        }

        .user-info h3 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .user-info p {
            color: var(--text-light);
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: var(--radius);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Progress Card */
        .progress-card {
            grid-column: span 2;
        }

        /* Active Objective Card */
        .active-card {
            grid-column: span 2;
        }

        /* Stats Grid - REORDERED to be after calendar */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: var(--transition);
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .stat-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: var(--primary);
            font-size: 20px;
        }

        .stat-card-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-card-label {
            color: var(--text-light);
            font-size: 14px;
        }

        /* Progress Indicators */
        .progress-indicator {
            margin-top: 10px;
        }

        .progress-level {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-level-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 1s ease;
        }

        /* Quick Actions - REORDERED position */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .quick-action {
            padding: 20px;
            background: var(--card);
            border-radius: var(--radius);
            text-align: center;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-action:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .quick-action-icon {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .progress-ring {
            width: 120px;
            height: 120px;
            position: relative;
            margin: 0 auto;
        }

        .progress-ring-circle {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring-bg {
            fill: none;
            stroke: var(--border);
            stroke-width: 8;
        }

        .progress-ring-fill {
            fill: none;
            stroke: var(--primary);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-dasharray: 314;
            stroke-dashoffset: 314;
            transition: stroke-dashoffset 1s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: 700;
            color: var(--text);
        }

        .todays-tasks {
            margin-top: 20px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 10px;
            transition: var(--transition);
            cursor: pointer;
        }

        .task-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px var(--shadow);
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid var(--border);
            margin-right: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .task-checkbox.checked {
            background: var(--secondary);
            border-color: var(--secondary);
            color: white;
            transform: scale(1.1);
        }

        .task-info {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .task-meta {
            font-size: 14px;
            color: var(--text-light);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* Calendar styling */
        .calendar-container {
            margin-bottom: 30px;
        }

        .calendar-view {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .calendar-day {
            aspect-ratio: 1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            background: var(--bg-secondary);
            position: relative;
            overflow: hidden;
        }

        .calendar-day:hover {
            background: var(--primary-light);
            color: var(--primary);
        }

        .calendar-day.active {
            background: var(--primary);
            color: white;
        }

        .calendar-day.has-event {
            border: 2px solid var(--secondary);
        }

        .calendar-day.has-task {
            border: 2px solid var(--accent);
        }

        .calendar-day.has-objective {
            border: 2px solid var(--primary);
        }

        .calendar-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 600;
            color: var(--text-light);
            font-size: 12px;
            text-transform: uppercase;
        }

        /* Calendar Event Indicators */
        .event-indicator {
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--secondary);
        }

        .task-indicator {
            background: var(--accent);
        }

        .objective-indicator {
            background: var(--primary);
        }

        /* Full Calendar Modal */
        .full-calendar-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .full-calendar-modal.active {
            display: flex;
        }

        .full-calendar-content {
            background: var(--card);
            border-radius: var(--radius);
            padding: 30px;
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .full-calendar-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 24px;
            cursor: pointer;
            z-index: 2;
        }

        .full-calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .month-navigation {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .full-calendar-view {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .full-calendar-day {
            min-height: 100px;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg-secondary);
            position: relative;
            overflow: hidden;
        }

        .full-calendar-day.today {
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .full-calendar-day-header {
            font-weight: 600;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border);
        }

        .calendar-events-list {
            margin-top: 5px;
            max-height: 70px;
            overflow-y: auto;
        }

        .calendar-event-item {
            font-size: 11px;
            padding: 2px 4px;
            margin-bottom: 2px;
            border-radius: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
        }

        .calendar-event-task {
            background: rgba(255, 171, 0, 0.1);
            color: var(--accent);
            border-left: 2px solid var(--accent);
        }

        .calendar-event-objective {
            background: rgba(74, 144, 226, 0.1);
            color: var(--primary);
            border-left: 2px solid var(--primary);
        }

        .calendar-event-custom {
            background: rgba(54, 179, 126, 0.1);
            color: var(--secondary);
            border-left: 2px solid var(--secondary);
        }

        /* Objectives */
        .objectives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .objective-card {
            transition: var(--transition);
            cursor: pointer;
        }

        .objective-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px var(--shadow);
        }

        .objective-progress {
            margin-top: 15px;
        }

        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 1s ease;
        }

        /* Progress Labels */
        .progress-container {
            margin: 15px 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 3000; /* Increased z-index for foreground */
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border-radius: var(--radius);
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        /* Timer Settings Modal */
        .timer-settings-modal {
            max-width: 400px;
        }

        .timer-settings-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .time-display-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        /* Form Elements - FIXED select positioning */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 16px;
            transition: var(--transition);
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }

        /* Custom dropdown arrow */
        .form-select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Grind Zone */
        .grind-zone {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            z-index: 2000;
            display: none;
            flex-direction: column;
            transition: background 1s ease;
        }

        .grind-zone.active {
            display: flex;
        }

        /* Break Zone */
        .break-zone {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), 
                        url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
            z-index: 2500;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .break-zone.active {
            display: flex;
        }

        .break-timer {
            font-size: 96px;
            font-weight: 300;
            font-family: 'Courier New', monospace;
            margin: 40px 0;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: pulse 2s infinite;
        }

        .break-message {
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 40px;
            max-width: 600px;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Background Images */
        .grind-zone.forest {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-zone.ocean {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-zone.skyline {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-zone.mountain {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-zone.coffee {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-zone.space {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
        }

        .grind-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }

        .grind-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
        }

        .timer {
            font-size: 96px;
            font-weight: 300;
            font-family: 'Courier New', monospace;
            margin: 40px 0;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .current-task {
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 40px;
            max-width: 600px;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Music Controls */
        .music-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }

        .music-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            cursor: pointer;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            transition: var(--transition);
        }

        .music-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .music-toggle.active {
            background: var(--secondary);
        }

        .spotify-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            background: #1DB954;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .spotify-btn:hover {
            background: #1ed760;
            transform: translateY(-2px);
        }

        .spotify-btn i {
            font-size: 18px;
        }

        .spotify-logo {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1DB954;
            font-weight: bold;
            font-size: 14px;
        }

        .timer-controls {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .timer-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .timer-btn.start {
            background: var(--secondary);
        }

        .timer-btn.pause {
            background: var(--accent);
        }

        .timer-btn.stop {
            background: var(--danger);
        }

        .timer-btn.settings {
            background: rgba(255, 255, 255, 0.2);
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
        }

        /* Grind Zone Buttons */
        .grind-action-buttons {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            z-index: 2;
        }

        .grind-action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .grind-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .grind-action-btn.spotify {
            background: rgba(29, 185, 84, 0.8);
        }

        .grind-action-btn.spotify:hover {
            background: rgba(29, 185, 84, 1);
        }

        .timer-btn:active {
            transform: scale(0.9);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .timer-btn.start:active {
            animation: buttonPress 0.3s ease;
        }

        .timer-btn.pause:active {
            animation: buttonPress 0.3s ease;
        }

        .timer-btn.stop:active {
            animation: buttonPress 0.3s ease;
        }

        @keyframes buttonPress {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        /* Timer Display Mode */
        .timer-mode-24h .timer {
            font-size: 80px;
        }

        .timer-mode-12h .timer::after {
            content: " AM";
            font-size: 40px;
            vertical-align: super;
            margin-left: 10px;
        }

        .timer-mode-12h .timer.pm::after {
            content: " PM";
        }

        /* Background Panel */
        .background-panel {
            position: absolute;
            right: -350px;
            top: 0;
            width: 350px;
            height: 100%;
            background: var(--card);
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.2);
            padding: 20px;
            transition: right 0.3s ease;
            z-index: 2001;
            display: flex;
            flex-direction: column;
        }

        .background-panel.active {
            right: 0;
        }

        .background-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .background-panel-header h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }

        .close-panel-btn {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 18px;
            padding: 5px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-panel-btn:hover {
            background: var(--bg-secondary);
            color: var(--text);
        }

        .background-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }

        .background-option {
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            position: relative;
            background-size: cover;
            background-position: center;
        }

        .background-option:hover {
            transform: scale(1.05);
        }

        .background-option.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary);
        }

        .background-option.forest {
            background-image: url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option.ocean {
            background-image: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option.skyline {
            background-image: url('https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option.mountain {
            background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option.coffee {
            background-image: url('https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option.space {
            background-image: url('https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80');
        }

        .background-option span {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            background: rgba(0, 0, 0, 0.5);
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* Settings */
        .settings-section {
            margin-bottom: 40px;
        }

        .settings-section h3 {
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 700;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .setting-info h4 {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .setting-info p {
            font-size: 14px;
            color: var(--text-light);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        /* Context Menu */
        .context-menu {
            position: fixed;
            background: var(--card);
            border-radius: var(--radius);
            box-shadow: 0 10px 30px var(--shadow);
            z-index: 1001;
            min-width: 200px;
            display: none;
            border: 1px solid var(--border);
        }

        .context-menu.active {
            display: block;
            animation: slideUp 0.2s ease;
        }

        .context-menu-item {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .context-menu-item:hover {
            background: var(--primary-light);
        }

        /* Tutorial Tips */
        .tutorial-tip {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card);
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: 0 10px 30px var(--shadow);
            max-width: 300px;
            z-index: 999;
            animation: slideUp 0.3s ease;
            border-left: 4px solid var(--accent);
            display: none;
        }

        .tip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .close-tip {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
        }

        /* Achievements Modal */
        .achievements-modal {
            max-width: 600px;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement-item {
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 2px solid var(--border);
            transition: var(--transition);
        }

        .achievement-item.unlocked {
            border-color: var(--secondary);
            background: linear-gradient(135deg, rgba(54, 179, 126, 0.1), transparent);
        }

        .achievement-item.locked {
            opacity: 0.7;
            filter: grayscale(0.5);
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .achievement-item.unlocked .achievement-icon {
            color: var(--secondary);
        }

        .achievement-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 14px;
            color: var(--text-light);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.2);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-icon {
            padding: 8px;
            border-radius: 8px;
            background: transparent;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-icon:hover {
            background: var(--bg-secondary);
            color: var(--text);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }

        /* Back Button */
        .back-button {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Finish Break Button */
        .finish-break-btn {
            margin-top: 30px;
            padding: 15px 30px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .finish-break-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        .mt-6 { margin-top: 24px; }
        .ml-2 { margin-left: 8px; }
        .text-muted { color: var(--text-light); }
        .text-sm { font-size: 14px; }
        .flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .items-center { align-items: center; }
        .grid { display: grid; }
        .gap-2 { gap: 8px; }
        .gap-6 { gap: 24px; }
        .grid-cols-1 { grid-template-columns: 1fr; }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--border);
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .status-active {
            background: rgba(54, 179, 126, 0.1);
            color: var(--secondary);
        }

        .status-paused {
            background: rgba(255, 171, 0, 0.1);
            color: var(--accent);
        }

        .status-completed {
            background: rgba(74, 144, 226, 0.1);
            color: var(--primary);
        }

        /* Priority Indicators */
        .priority-high {
            color: var(--danger);
            font-weight: bold;
        }

        .priority-medium {
            color: var(--accent);
        }

        .priority-low {
            color: var(--secondary);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: var(--card);
            border-radius: var(--radius);
            box-shadow: 0 8px 24px var(--shadow);
            border-left: 4px solid var(--secondary);
            z-index: 3000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Animations */
        .pulse {
            animation: pulse 2s infinite;
        }

        .bounce {
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .slide-in {
            animation: slideUp 0.5s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .objectives-grid {
                grid-template-columns: 1fr;
            }
            
            .timer {
                font-size: 72px;
            }
            
            .break-timer {
                font-size: 72px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .background-panel {
                width: 100%;
                right: -100%;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .calendar-view {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .full-calendar-day {
                min-height: 80px;
                padding: 5px;
                font-size: 12px;
            }
            
            .timer-mode-24h .timer {
                font-size: 60px;
            }
            
            .timer-mode-12h .timer {
                font-size: 60px;
            }
            
            .timer-mode-12h .timer::after {
                font-size: 30px;
            }
            
            .grind-action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .music-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .progress-card,
            .active-card {
                grid-column: 1;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .calendar-view {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .full-calendar-day {
                min-height: 60px;
                font-size: 10px;
            }
            
            .timer {
                font-size: 60px;
            }
            
            .break-timer {
                font-size: 60px;
            }
            
            .timer-mode-24h .timer {
                font-size: 50px;
            }
            
            .timer-mode-12h .timer {
                font-size: 50px;
            }
        }
    </style>
</head>
<body>
    <!-- Setup Modal -->
    <div class="setup-modal" id="setupModal">
        <div class="setup-content">
            <div class="setup-header">
                <i class="fas fa-bullseye"></i>
                <h2>Welcome to FocusFlow</h2>
                <p>Let's personalize your experience</p>
            </div>

            <div class="setup-progress">
                <div class="progress-step active" id="step1Indicator">
                    <div class="step-circle">1</div>
                    <div class="step-label">Personal Info</div>
                </div>
                <div class="progress-step" id="step2Indicator">
                    <div class="step-circle">2</div>
                    <div class="step-label">First Steps</div>
                </div>
                <div class="progress-step" id="step3Indicator">
                    <div class="step-circle">3</div>
                    <div class="step-label">Preferences</div>
                </div>
            </div>

            <div class="setup-steps">
                <div class="setup-step active" id="step1">
                    <div class="form-group">
                        <label class="form-label" for="userName">What's your name?</label>
                        <input type="text" class="form-input" id="userName" placeholder="Enter your name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="userFocus">What's your primary focus area?</label>
                        <select class="form-select" id="userFocus" required>
                            <option value="">Select your focus</option>
                            <option value="academic">Academic & Study</option>
                            <option value="career">Career & Professional</option>
                            <option value="creative">Creative Projects</option>
                            <option value="entrepreneur">Entrepreneurship</option>
                            <option value="personal">Personal Development</option>
                            <option value="fitness">Health & Fitness</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="setup-step hidden" id="step2">
                    <div class="form-group">
                        <label class="form-label" for="setupObjective">Create your first objective</label>
                        <input type="text" class="form-input" id="setupObjective" placeholder="e.g., Learn JavaScript basics" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="setupTask">Create your first task</label>
                        <input type="text" class="form-input" id="setupTask" placeholder="e.g., Complete JavaScript tutorial" required>
                    </div>
                </div>
                
                <div class="setup-step hidden" id="step3">
                    <div class="form-group">
                        <label class="form-label" for="workStyle">How do you prefer to work?</label>
                        <select class="form-select" id="workStyle" required>
                            <option value="">Select work style</option>
                            <option value="pomodoro">Pomodoro Technique (25/5)</option>
                            <option value="deep">Deep Work (90 min blocks)</option>
                            <option value="timeblocking">Time Blocking</option>
                            <option value="flexible">Flexible Sessions</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="motivationType">What motivates you most?</label>
                        <select class="form-select" id="motivationType" required>
                            <option value="">Select motivation type</option>
                            <option value="progress">Seeing Progress</option>
                            <option value="deadlines">Deadlines & Accountability</option>
                            <option value="rewards">Rewards & Recognition</option>
                            <option value="intrinsic">Intrinsic Satisfaction</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="setup-buttons">
                <button class="btn btn-secondary hidden" id="prevBtn">Previous</button>
                <button class="btn btn-primary" id="nextBtn">Next Step</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="mainApp" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-bullseye"></i>
                <h1>FocusFlow</h1>
            </div>
            <div class="header-controls">
                <button class="btn-icon" id="themeToggle" title="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn btn-primary" id="startGrindBtn">
                    <i class="fas fa-play"></i> Start Grind
                </button>
            </div>
        </header>

        <!-- Search Bar -->
        <div class="search-bar">
            <input type="text" class="search-input" id="globalSearch" placeholder="Search tasks, objectives, events...">
            <div class="search-icon">
                <i class="fas fa-search"></i>
            </div>
            <button class="search-clear" id="clearSearch">Clear</button>
        </div>

        <!-- Content Bar -->
        <div class="content-bar" id="contentBar">
            <h2 class="content-title" id="currentPageTitle">
                <i class="fas fa-home"></i> Dashboard
            </h2>
            <div class="page-actions" id="pageActions">
                <!-- Page-specific actions will be added here -->
            </div>
        </div>

        <!-- Quotes Bar -->
        <div class="quotes-bar" id="quotesBar">
            <div class="quote-content">
                <div class="quote-text" id="currentQuote">Loading quote...</div>
                <div class="quote-author" id="quoteAuthor"> Loading author</div>
            </div>
            <div class="quote-controls">
                <button class="btn-icon" id="prevQuoteBtn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="btn-icon" id="toggleQuotesBtn">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn-icon" id="nextQuoteBtn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="nav">
            <button class="nav-btn active" data-section="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </button>
            <button class="nav-btn" data-section="objectives">
                <i class="fas fa-bullseye"></i> Objectives
            </button>
            <button class="nav-btn" data-section="tasks">
                <i class="fas fa-tasks"></i> Tasks
            </button>
            <button class="nav-btn" data-section="progress">
                <i class="fas fa-chart-line"></i> Progress
            </button>
            <button class="nav-btn" data-section="calendar">
                <i class="fas fa-calendar"></i> Calendar
            </button>
            <button class="nav-btn" data-section="settings">
                <i class="fas fa-cog"></i> Settings
            </button>
        </nav>

        <!-- Dashboard Section - REORDERED -->
        <section id="dashboard" class="content-section active">
            <!-- Welcome Card -->
            <div class="card welcome-card">
                <div class="user-welcome">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-info">
                        <h3 id="welcomeMessage">Welcome back!</h3>
                        <p id="userFocusDisplay">Focus Area: Not set</p>
                    </div>
                </div>
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="dailyGoalDisplay">0m</div>
                        <div class="stat-label">Daily Goal</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="streakDisplay">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="completedToday">0</div>
                        <div class="stat-label">Completed Today</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="focusTimeToday">00</div>
                        <div class="stat-label">Focus Today (min)</div>
                    </div>
                </div>
            </div>

            <!-- Progress and Active Objective Row -->
            <div class="dashboard-grid">
                <!-- Progress Card -->
                <div class="card progress-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-chart-pie"></i> Overall Progress
                        </h2>
                    </div>
                    <div class="text-center">
                        <div class="progress-ring">
                            <svg class="progress-ring-circle" width="120" height="120">
                                <circle class="progress-ring-bg" cx="60" cy="60" r="52"></circle>
                                <circle class="progress-ring-fill" cx="60" cy="60" r="52"></circle>
                            </svg>
                            <div class="progress-text" id="overallProgress">0%</div>
                        </div>
                        <p class="mt-2 text-muted" id="progressMessage">Start your journey today!</p>
                    </div>
                </div>

                <!-- Active Objective Card -->
                <div class="card active-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-star"></i> Active Objective
                        </h2>
                        <button class="btn btn-secondary btn-sm" onclick="app.changeActiveObjective()">
                            Change
                        </button>
                    </div>
                    <div id="activeObjectiveContent">
                        <div class="empty-state" id="emptyObjective">
                            <i class="fas fa-bullseye"></i>
                            <h3>No active objective</h3>
                            <p>Set an active objective to focus your efforts</p>
                            <button class="btn btn-primary mt-3" onclick="app.openObjectiveModal()">
                                Set Objective
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions" id="quickActions">
                <div class="quick-action" onclick="app.openGrindZone()">
                    <div class="quick-action-icon">
                        <i class="fas fa-play"></i>
                    </div>
                    <div>Start Focus Session</div>
                </div>
                <div class="quick-action" onclick="app.startBreak()">
                    <div class="quick-action-icon">
                        <i class="fas fa-coffee"></i>
                    </div>
                    <div>Take a Break</div>
                </div>
                <div class="quick-action" onclick="app.generateReport()">
                    <div class="quick-action-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div>Generate Report</div>
                </div>
            </div>

            <!-- Calendar View - Moved up -->
            <div class="card calendar-container" id="calendarCard">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-calendar"></i> This Week
                    </h2>
                    <button class="btn btn-secondary btn-sm" onclick="app.viewFullCalendar()">
                        View All
                    </button>
                </div>
                <div class="calendar-header">
                    <div>Sun</div>
                    <div>Mon</div>
                    <div>Tue</div>
                    <div>Wed</div>
                    <div>Thu</div>
                    <div>Fri</div>
                    <div>Sat</div>
                </div>
                <div class="calendar-view" id="weekCalendar">
                    <!-- Calendar days will be generated here -->
                </div>
            </div>

            <!-- Stats Grid - Moved down -->
            <div class="stats-grid" id="enhancedStats">
                <!-- Stats will be dynamically added here -->
            </div>

            <!-- Today's Tasks -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-calendar-day"></i> Today's Tasks
                    </h2>
                    <button class="btn btn-secondary btn-sm" onclick="app.openTaskModal()">
                        <i class="fas fa-plus"></i> Add
                    </button>
                </div>
                <div class="todays-tasks" id="todayTasks">
                    <div class="empty-state" id="emptyToday">
                        <i class="fas fa-calendar-plus"></i>
                        <h3>No tasks for today</h3>
                        <p>Add tasks to get started</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Objectives Section -->
        <section id="objectives" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-bullseye"></i> Your Objectives
                    </h2>
                    <div>
                        <button class="btn btn-primary" onclick="app.openObjectiveModal()">
                            <i class="fas fa-plus"></i> Create Objective
                        </button>
                    </div>
                </div>
                <div id="objectivesList" class="objectives-grid">
                    <!-- Objectives will be dynamically added here -->
                </div>
            </div>
        </section>

        <!-- Tasks Section -->
        <section id="tasks" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-tasks"></i> Task Management
                    </h2>
                    <div>
                        <button class="btn btn-primary" onclick="app.openTaskModal()">
                            <i class="fas fa-plus"></i> Create Task
                        </button>
                    </div>
                </div>
                <div id="tasksContainer">
                    <div id="tasksList">
                        <!-- Tasks will be dynamically added here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section id="progress" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-chart-line"></i> Progress Analytics
                    </h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center">
                        <div class="stat-card-value" id="totalHours">0</div>
                        <p class="text-muted">Total Focus Hours</p>
                    </div>
                    <div class="text-center">
                        <div class="stat-card-value" id="completedTasks">0</div>
                        <p class="text-muted">Completed Tasks</p>
                    </div>
                    <div class="text-center">
                        <div class="stat-card-value" id="completionRate">0%</div>
                        <p class="text-muted">Completion Rate</p>
                    </div>
                </div>
                <div class="mt-6">
                    <h3 class="font-bold mb-4">Weekly Focus Heatmap</h3>
                    <div id="heatmap" class="flex flex-wrap gap-2">
                        <!-- Heatmap will be generated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-calendar-alt"></i> Calendar
                    </h2>
                    <div>
                        <button class="btn btn-primary" onclick="app.openCalendarEventModal()">
                            <i class="fas fa-plus"></i> Add Event
                        </button>
                    </div>
                </div>
                <div id="calendarMonthView">
                    <!-- Monthly calendar will be generated here -->
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="content-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-cog"></i> Settings
                    </h2>
                </div>

                <div class="settings-section">
                    <h3>Personalization</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>User Name</h4>
                            <p id="userNameDisplay">Not set</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.editUserName()">Edit</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Focus Area</h4>
                            <p id="focusAreaDisplay">Not set</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.editFocusArea()">Change</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Work Style</h4>
                            <p id="workStyleDisplay">Standard</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.editWorkStyle()">Change</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Timer Settings</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Default Focus Duration</h4>
                            <p id="focusDurationDisplay">25 minutes</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.openTimerSettings()">Edit</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Break Duration</h4>
                            <p id="breakDurationDisplay">5 minutes</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.openTimerSettings()">Edit</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Timer Display</h4>
                            <p id="timerDisplayMode">24-hour format</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.openTimerSettings()">Change</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Music Settings</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Background Music</h4>
                            <p>Lo-fi music for focus sessions</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="musicToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Spotify Integration</h4>
                            <p>Connect your Spotify account</p>
                        </div>
                        <button class="btn btn-success" onclick="app.connectSpotify()">
                            <i class="fab fa-spotify"></i> Connect
                        </button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Preferences</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Dark Mode</h4>
                            <p>Switch between light and dark theme</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Pomodoro Timer</h4>
                            <p>Enable 25/5 minute work/break cycles</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pomodoroToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Notifications</h4>
                            <p>Get session reminders and updates</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="notificationsToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Data Management</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Export Data</h4>
                            <p>Download your objectives and tasks as JSON</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.exportData()">Export</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Import Data</h4>
                            <p>Import objectives and tasks from JSON file</p>
                        </div>
                        <button class="btn btn-secondary" onclick="app.importData()">Import</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Clear All Data</h4>
                            <p>Reset the application to initial state</p>
                        </div>
                        <button class="btn btn-danger" onclick="app.clearData()">Clear All</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>About</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Version</h4>
                            <p>FocusFlow 2.3.0</p>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Developer</h4>
                            <p>Built with  for productive minds</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Grind Zone -->
    <div class="grind-zone" id="grindZone">
        <div class="background-panel" id="backgroundPanel">
            <div class="background-panel-header">
                <h3>Choose Background</h3>
                <button class="close-panel-btn" id="closePanelBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="background-grid">
                <div class="background-option forest active" data-bg="forest">
                    <span>Forest</span>
                </div>
                <div class="background-option ocean" data-bg="ocean">
                    <span>Ocean</span>
                </div>
                <div class="background-option skyline" data-bg="skyline">
                    <span>Skyline</span>
                </div>
                <div class="background-option mountain" data-bg="mountain">
                    <span>Mountain</span>
                </div>
                <div class="background-option coffee" data-bg="coffee">
                    <span>Coffee Shop</span>
                </div>
                <div class="background-option space" data-bg="space">
                    <span>Space</span>
                </div>
            </div>
        </div>

        <div class="grind-header">
            <div>
                <button class="back-button" onclick="app.closeGrindZone()">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </button>
                <h2 style="margin-top: 10px;">Grind Zone</h2>
                <p id="grindSessionInfo">Focus Session</p>
            </div>
        </div>

        <!-- Action buttons -->
        <div class="grind-action-buttons">
            <button class="grind-action-btn" id="backgroundToggleBtn">
                <i class="fas fa-palette"></i> Background
            </button>
            <button class="grind-action-btn spotify" id="spotifyConnectBtn">
                <div class="spotify-logo"></div>
                <span>Spotify</span>
            </button>
            <button class="grind-action-btn" id="timerSettingsBtn">
                <i class="fas fa-clock"></i> Timer Settings
            </button>
        </div>

        <div class="grind-content">
            <div class="current-task" id="grindTask">No task selected</div>
            <div class="timer" id="grindTimer">25:00</div>
            
            <!-- Music toggle -->
            <div class="music-controls">
                <div class="music-toggle" id="musicToggleBtn">
                    <i class="fas fa-music"></i>
                    <span>Music</span>
                </div>
            </div>
            
            <div class="timer-controls">
                <button class="timer-btn start" id="startTimerBtn">
                    <i class="fas fa-play"></i>
                </button>
                <button class="timer-btn pause" id="pauseTimerBtn">
                    <i class="fas fa-pause"></i>
                </button>
                <button class="timer-btn stop" id="stopTimerBtn">
                    <i class="fas fa-stop"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Break Zone -->
    <div class="break-zone" id="breakZone">
        <div class="break-content">
            <h1 style="font-size: 48px; margin-bottom: 20px;">Break Time</h1>
            <div class="break-message" id="breakMessage">Take a deep breath and relax...</div>
            <div class="break-timer" id="breakTimer">05:00</div>
            <div class="break-message" id="breakEndMessage"></div>
            <button class="finish-break-btn" id="finishBreakBtn">
                <i class="fas fa-check"></i> Finish Break
            </button>
        </div>
    </div>

    <!-- Achievements Modal -->
    <div class="modal" id="achievementsModal">
        <div class="modal-content achievements-modal">
            <div class="modal-header">
                <h3 class="modal-title">Your Achievements</h3>
                <button class="btn-icon" id="closeAchievementsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="achievementsGrid" class="achievements-grid">
                <!-- Achievements will be dynamically added here -->
            </div>
            <div class="text-right mt-6">
                <button class="btn btn-primary" id="closeAchievementsBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Timer Settings Modal -->
    <div class="modal" id="timerSettingsModal">
        <div class="modal-content timer-settings-modal">
            <div class="modal-header">
                <h3 class="modal-title">Timer Settings</h3>
                <button class="btn-icon" id="closeTimerSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="timerSettingsForm">
                <div class="timer-settings-group">
                    <div class="form-group">
                        <label class="form-label" for="focusDuration">Focus Duration (min)</label>
                        <input type="number" class="form-input" id="focusDuration" min="1" max="120" value="25">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="breakDuration">Break Duration (min)</label>
                        <input type="number" class="form-input" id="breakDuration" min="1" max="60" value="5">
                    </div>
                </div>
                <div class="time-display-toggle">
                    <label class="toggle-switch">
                        <input type="checkbox" id="timer24hToggle">
                        <span class="toggle-slider"></span>
                    </label>
                    <span>24-hour format</span>
                </div>
                <div class="text-right mt-6">
                    <button type="button" class="btn btn-secondary" id="cancelTimerSettingsBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary ml-2">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Calendar Event Modal -->
    <div class="modal" id="calendarEventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="calendarEventModalTitle">Add Calendar Event</h3>
                <button class="btn-icon" id="closeCalendarEventModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="calendarEventForm">
                <input type="hidden" id="calendarEventId">
                <div class="form-group">
                    <label class="form-label" for="eventTitle">Event Title</label>
                    <input type="text" class="form-input" id="eventTitle" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="eventDescription">Description</label>
                    <textarea class="form-textarea" id="eventDescription"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" for="eventType">Event Type</label>
                    <select class="form-select" id="eventType" required>
                        <option value="">Select event type</option>
                        <option value="custom">Custom Event</option>
                        <option value="task">Task Deadline</option>
                        <option value="objective">Objective Deadline</option>
                    </select>
                </div>
                <div class="form-group" id="linkedTaskGroup" style="display: none;">
                    <label class="form-label" for="linkedTask">Linked Task</label>
                    <select class="form-select" id="linkedTask">
                        <option value="">Select task</option>
                    </select>
                </div>
                <div class="form-group" id="linkedObjectiveGroup" style="display: none;">
                    <label class="form-label" for="linkedObjective">Linked Objective</label>
                    <select class="form-select" id="linkedObjective">
                        <option value="">Select objective</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="eventDate">Date</label>
                        <input type="date" class="form-input" id="eventDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventTime">Time (Optional)</label>
                        <input type="time" class="form-input" id="eventTime">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="eventColor">Color</label>
                        <select class="form-select" id="eventColor">
                            <option value="">Select color</option>
                            <option value="#4A90E2">Blue</option>
                            <option value="#36B37E">Green</option>
                            <option value="#FFAB00">Yellow</option>
                            <option value="#FF5630">Red</option>
                            <option value="#8E44AD">Purple</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="eventPriority">Priority</label>
                        <select class="form-select" id="eventPriority">
                            <option value="">Select priority</option>
                            <option value="1">Low</option>
                            <option value="2">Medium</option>
                            <option value="3">High</option>
                        </select>
                    </div>
                </div>
                <div class="text-right mt-6">
                    <button type="button" class="btn btn-secondary" id="cancelCalendarEventBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary ml-2">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Full Calendar Modal -->
    <div class="full-calendar-modal" id="fullCalendarModal">
        <div class="full-calendar-content">
            <button class="full-calendar-close" onclick="app.closeFullCalendar()">
                <i class="fas fa-times"></i>
            </button>
            <div class="full-calendar-header">
                <h2 id="fullCalendarMonth">Calendar</h2>
                <div class="month-navigation">
                    <button class="btn btn-secondary btn-sm" onclick="app.prevMonth()">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="app.nextMonth()">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="app.openCalendarEventModal()">
                        <i class="fas fa-plus"></i> Add Event
                    </button>
                </div>
            </div>
            <div class="calendar-header">
                <div>Sun</div>
                <div>Mon</div>
                <div>Tue</div>
                <div>Wed</div>
                <div>Thu</div>
                <div>Fri</div>
                <div>Sat</div>
            </div>
            <div class="full-calendar-view" id="fullCalendarDays">
                <!-- Full calendar days will be generated here -->
            </div>
        </div>
    </div>

    <!-- Objective Modal -->
    <div class="modal" id="objectiveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="objectiveModalTitle">New Objective</h3>
                <button class="btn-icon" id="closeObjectiveModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="objectiveForm">
                <input type="hidden" id="objectiveId">
                <div class="form-group">
                    <label class="form-label" for="objectiveTitle">Title</label>
                    <input type="text" class="form-input" id="objectiveTitle" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="objectiveDescription">Description</label>
                    <textarea class="form-textarea" id="objectiveDescription"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="objectiveCategory">Category</label>
                        <select class="form-select" id="objectiveCategory" required>
                            <option value="">Select category</option>
                            <option value="academic">Academic</option>
                            <option value="career">Career</option>
                            <option value="personal">Personal</option>
                            <option value="health">Health & Fitness</option>
                            <option value="skill">Skill Development</option>
                            <option value="creative">Creative</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="objectiveTimeRange">Time Range</label>
                        <select class="form-select" id="objectiveTimeRange" required>
                            <option value="">Select time range</option>
                            <option value="short">Short Term (1-3 months)</option>
                            <option value="medium">Medium Term (3-12 months)</option>
                            <option value="long">Long Term (1+ years)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="objectivePriority">Priority</label>
                        <select class="form-select" id="objectivePriority" required>
                            <option value="">Select priority</option>
                            <option value="1">Low</option>
                            <option value="2">Medium-Low</option>
                            <option value="3">Medium</option>
                            <option value="4">High</option>
                            <option value="5">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="objectiveStatus">Status</label>
                        <select class="form-select" id="objectiveStatus" required>
                            <option value="">Select status</option>
                            <option value="active">Active</option>
                            <option value="paused">Paused</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="objectiveDeadline">Target Date (Optional)</label>
                    <input type="date" class="form-input" id="objectiveDeadline">
                </div>
                <div class="text-right mt-6">
                    <button type="button" class="btn btn-secondary" id="cancelObjectiveBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary ml-2">Save Objective</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="taskModalTitle">New Task</h3>
                <button class="btn-icon" id="closeTaskModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="taskForm">
                <input type="hidden" id="taskId">
                <div class="form-group">
                    <label class="form-label" for="taskTitle">Title</label>
                    <input type="text" class="form-input" id="taskTitle" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="taskDescription">Description</label>
                    <textarea class="form-textarea" id="taskDescription"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label" for="taskObjective">Linked Objective</label>
                    <select class="form-select" id="taskObjective" required>
                        <option value="">Select objective</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="taskDeadline">Deadline</label>
                        <input type="date" class="form-input" id="taskDeadline" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="taskDuration">Estimated Duration (hours)</label>
                        <input type="number" class="form-input" id="taskDuration" min="0.5" step="0.5" value="1">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="taskImportance">Importance</label>
                        <select class="form-select" id="taskImportance">
                            <option value="">Select importance</option>
                            <option value="1">Low</option>
                            <option value="2">Medium</option>
                            <option value="3">High</option>
                            <option value="4">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="taskStatus">Status</label>
                        <select class="form-select" id="taskStatus">
                            <option value="">Select status</option>
                            <option value="not-started">Not Started</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                </div>
                <div class="text-right mt-6">
                    <button type="button" class="btn btn-secondary" id="cancelTaskBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary ml-2">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" data-action="edit">
            <i class="fas fa-edit"></i> Edit
        </div>
        <div class="context-menu-item" data-action="delete">
            <i class="fas fa-trash"></i> Delete
        </div>
        <div class="context-menu-item" data-action="duplicate">
            <i class="fas fa-copy"></i> Duplicate
        </div>
        <div class="context-menu-item" data-action="mark-done">
            <i class="fas fa-check"></i> Mark as Done
        </div>
    </div>

    <!-- Tutorial Tip -->
    <div class="tutorial-tip" id="tutorialTip">
        <div class="tip-header">
            <h4> Quick Tip</h4>
            <button class="close-tip" id="closeTipBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <p id="tipContent">Use the grind zone for focused work sessions!</p>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div id="notificationMessage">Operation completed successfully</div>
    </div>

    <!-- NEW: YouTube Iframe for Music -->
    <iframe id="youtubeMusic" style="display: none;" width="0" height="0" src="https://www.youtube.com/embed/jfKfPfyJRdk?si=Qo6CCOi9pXksg0X-&amp;controls=0&amp;autoplay=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

    <script>
        class FocusFlowApp {
            constructor() {
                this.currentStep = 1;
                this.timer = {
                    minutes: 25,
                    seconds: 0,
                    running: false,
                    interval: null,
                    totalSeconds: 25 * 60,
                    isFocus: true
                };
                
                // Timer settings
                this.timerSettings = {
                    focusDuration: 25,
                    breakDuration: 5,
                    use24hFormat: true
                };
                
                // Music settings
                this.musicSettings = {
                    enabled: false, // Start with music off
                    volume: 0.5,
                    connectedToSpotify: false,
                    youtubePlayer: null
                };
                
                // Calendar state
                this.calendarDate = new Date();
                this.selectedCalendarDate = null;
                
                // Break timer
                this.breakTimer = {
                    minutes: 5,
                    seconds: 0,
                    running: false,
                    interval: null,
                    totalSeconds: 5 * 60
                };
                
                // Break messages
                this.breakMessages = [
                    "Break time's over! Ready to get back to work?",
                    "Refreshed and recharged! Time to focus.",
                    "Break complete! Let's tackle those tasks.",
                    "Back to work! You've got this.",
                    "Break's over! Time to make progress.",
                    "Ready to dive back in? Let's go!",
                    "Energized and ready! Back to focusing.",
                    "Break's done! Let's crush those goals.",
                    "Recharged! Time to get productive.",
                    "Break time up! Ready to focus?"
                ];
                
                // Quotes system
                this.quotes = [
                    { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
                    { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
                    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
                    { text: "Your time is limited, don't waste it living someone else's life.", author: "Steve Jobs" },
                    { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
                    { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
                    { text: "Don't be pushed by your problems. Be led by your dreams.", author: "Ralph Waldo Emerson" },
                    { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
                    { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
                    { text: "Quality is not an act, it is a habit.", author: "Aristotle" }
                ];
                this.currentQuoteIndex = 0;
                this.showQuotesBar = true;
                
                // Achievements system
                this.achievements = [
                    { id: 'first_task', title: 'First Task', description: 'Complete your first task', icon: 'fa-check', unlocked: false },
                    { id: 'streak_7', title: '7-Day Streak', description: 'Maintain a 7-day focus streak', icon: 'fa-fire', unlocked: false },
                    { id: 'focus_master', title: 'Focus Master', description: 'Complete 10 focus sessions', icon: 'fa-brain', unlocked: false },
                    { id: 'early_bird', title: 'Early Bird', description: 'Start a focus session before 8 AM', icon: 'fa-sun', unlocked: false },
                    { id: 'night_owl', title: 'Night Owl', description: 'Start a focus session after 8 PM', icon: 'fa-moon', unlocked: false },
                    { id: 'marathon', title: 'Marathon', description: 'Complete a 2-hour focus session', icon: 'fa-running', unlocked: false },
                    { id: 'objective_complete', title: 'Goal Getter', description: 'Complete your first objective', icon: 'fa-trophy', unlocked: false },
                    { id: 'break_king', title: 'Break King', description: 'Take 10 breaks', icon: 'fa-coffee', unlocked: false }
                ];
                
                // Context menu
                this.contextMenuTarget = null;
                
                this.init();
            }

            init() {
                this.loadData();
                this.setupEventListeners();
                this.checkSetup();
                this.initQuotes();
                this.initContextMenu();
                this.showTutorialTip();
                
                // Start quote rotation
                setInterval(() => this.nextQuote(), 30000);
            }

            checkSetup() {
                if (!this.settings || !this.settings.setupCompleted) {
                    document.getElementById('setupModal').style.display = 'flex';
                    document.getElementById('mainApp').style.display = 'none';
                } else {
                    document.getElementById('setupModal').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    this.updateUI();
                }
            }

            loadData() {
                // Load objectives
                const objectivesData = localStorage.getItem('focusFlow_objectives');
                this.objectives = objectivesData ? JSON.parse(objectivesData) : [];

                // Load tasks
                const tasksData = localStorage.getItem('focusFlow_tasks');
                this.tasks = tasksData ? JSON.parse(tasksData) : [];

                // Load calendar events
                const eventsData = localStorage.getItem('focusFlow_calendarEvents');
                this.calendarEvents = eventsData ? JSON.parse(eventsData) : [];

                // Load settings
                const settingsData = localStorage.getItem('focusFlow_settings');
                this.settings = settingsData ? JSON.parse(settingsData) : {
                    darkMode: false,
                    setupCompleted: false,
                    userName: '',
                    userFocus: '',
                    workStyle: '',
                    motivationType: '',
                    activeObjective: null,
                    streak: 0,
                    lastActiveDate: null,
                    totalFocusHours: 0,
                    todayFocusMinutes: 0,
                    focusSessions: [],
                    todayTasksCompleted: 0,
                    achievementsUnlocked: []
                };

                // Load grind zone settings
                const grindData = localStorage.getItem('focusFlow_grind');
                this.grindSettings = grindData ? JSON.parse(grindData) : {
                    background: 'forest',
                    pomodoroDuration: 25,
                    breakDuration: 5
                };

                // Load timer settings
                const timerSettingsData = localStorage.getItem('focusFlow_timerSettings');
                if (timerSettingsData) {
                    this.timerSettings = JSON.parse(timerSettingsData);
                    this.timer.minutes = this.timerSettings.focusDuration;
                    this.timer.totalSeconds = this.timerSettings.focusDuration * 60;
                }

                // Load music settings
                const musicSettingsData = localStorage.getItem('focusFlow_musicSettings');
                if (musicSettingsData) {
                    this.musicSettings = JSON.parse(musicSettingsData);
                }

                // Load achievements
                const achievementsData = localStorage.getItem('focusFlow_achievements');
                if (achievementsData) {
                    this.achievements = JSON.parse(achievementsData);
                }

                // Check streak
                this.checkStreak();
                
                // Update achievements
                this.updateAchievements();
            }

            saveData() {
                localStorage.setItem('focusFlow_objectives', JSON.stringify(this.objectives));
                localStorage.setItem('focusFlow_tasks', JSON.stringify(this.tasks));
                localStorage.setItem('focusFlow_calendarEvents', JSON.stringify(this.calendarEvents));
                localStorage.setItem('focusFlow_settings', JSON.stringify(this.settings));
                localStorage.setItem('focusFlow_grind', JSON.stringify(this.grindSettings));
                localStorage.setItem('focusFlow_timerSettings', JSON.stringify(this.timerSettings));
                localStorage.setItem('focusFlow_musicSettings', JSON.stringify(this.musicSettings));
                localStorage.setItem('focusFlow_achievements', JSON.stringify(this.achievements));
            }

            checkStreak() {
                const today = new Date().toDateString();
                const lastActive = this.settings.lastActiveDate;

                if (lastActive) {
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (lastActive === yesterday.toDateString()) {
                        this.settings.streak++;
                        this.settings.lastActiveDate = today;
                        // Reset today's focus minutes for new day
                        this.settings.todayFocusMinutes = 0;
                        this.settings.todayTasksCompleted = 0;
                    } else if (lastActive !== today) {
                        this.settings.streak = 1;
                        this.settings.lastActiveDate = today;
                        // Reset today's focus minutes for new day
                        this.settings.todayFocusMinutes = 0;
                        this.settings.todayTasksCompleted = 0;
                    }
                } else {
                    this.settings.streak = 1;
                    this.settings.lastActiveDate = today;
                    this.settings.todayFocusMinutes = 0;
                    this.settings.todayTasksCompleted = 0;
                }
                this.saveData();
            }

            updateAchievements() {
                // Check for achievement unlocks
                this.achievements.forEach(achievement => {
                    if (!achievement.unlocked) {
                        switch(achievement.id) {
                            case 'first_task':
                                if (this.tasks.some(task => task.status === 'completed')) {
                                    achievement.unlocked = true;
                                }
                                break;
                            case 'streak_7':
                                if (this.settings.streak >= 7) {
                                    achievement.unlocked = true;
                                }
                                break;
                            case 'focus_master':
                                if (this.settings.focusSessions.length >= 10) {
                                    achievement.unlocked = true;
                                }
                                break;
                            case 'objective_complete':
                                if (this.objectives.some(obj => obj.status === 'completed')) {
                                    achievement.unlocked = true;
                                }
                                break;
                        }
                    }
                });
                this.saveData();
            }

            setupEventListeners() {
                // Setup modal
                document.getElementById('nextBtn').addEventListener('click', () => this.nextStep());
                document.getElementById('prevBtn').addEventListener('click', () => this.prevStep());

                // Navigation
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.switchSection(btn.dataset.section));
                });

                // Theme toggle
                document.getElementById('themeToggle').addEventListener('click', () => this.toggleTheme());
                document.getElementById('darkModeToggle').addEventListener('change', (e) => {
                    this.settings.darkMode = e.target.checked;
                    this.saveData();
                    this.applyTheme();
                });

                // Music toggle
                document.getElementById('musicToggle')?.addEventListener('change', (e) => {
                    this.musicSettings.enabled = e.target.checked;
                    this.saveData();
                    this.updateMusic();
                });

                // Grind Zone
                document.getElementById('startGrindBtn').addEventListener('click', () => this.openGrindZone());
                document.getElementById('backgroundToggleBtn').addEventListener('click', () => this.toggleBackgroundPanel());
                document.getElementById('timerSettingsBtn').addEventListener('click', () => this.openTimerSettings());
                document.getElementById('spotifyConnectBtn').addEventListener('click', () => this.connectSpotify());
                document.getElementById('musicToggleBtn').addEventListener('click', () => this.toggleMusic());
                
                // Close panel button
                document.getElementById('closePanelBtn').addEventListener('click', () => this.closeBackgroundPanel());

                // Background selection
                document.querySelectorAll('.background-option').forEach(option => {
                    option.addEventListener('click', () => this.selectBackground(option.dataset.bg));
                });

                // Timer controls with animations
                document.getElementById('startTimerBtn').addEventListener('click', (e) => {
                    this.startTimer();
                    this.animateButton(e.target.closest('.timer-btn'));
                });

                document.getElementById('pauseTimerBtn').addEventListener('click', (e) => {
                    this.pauseTimer();
                    this.animateButton(e.target.closest('.timer-btn'));
                });

                document.getElementById('stopTimerBtn').addEventListener('click', (e) => {
                    this.stopTimer();
                    this.animateButton(e.target.closest('.timer-btn'));
                });

                // Timer settings
                document.getElementById('timerSettingsForm')?.addEventListener('submit', (e) => this.saveTimerSettings(e));
                document.getElementById('closeTimerSettingsModal')?.addEventListener('click', () => this.closeTimerSettings());
                document.getElementById('cancelTimerSettingsBtn')?.addEventListener('click', () => this.closeTimerSettings());

                // Break controls
                document.getElementById('finishBreakBtn')?.addEventListener('click', () => this.finishBreak());

                // Calendar event form
                document.getElementById('calendarEventForm')?.addEventListener('submit', (e) => this.saveCalendarEvent(e));
                document.getElementById('closeCalendarEventModal')?.addEventListener('click', () => this.closeCalendarEventModal());
                document.getElementById('cancelCalendarEventBtn')?.addEventListener('click', () => this.closeCalendarEventModal());
                document.getElementById('eventType')?.addEventListener('change', (e) => this.handleEventTypeChange(e));

                // Objective management
                document.getElementById('closeObjectiveModal').addEventListener('click', () => this.closeObjectiveModal());
                document.getElementById('cancelObjectiveBtn').addEventListener('click', () => this.closeObjectiveModal());
                document.getElementById('objectiveForm').addEventListener('submit', (e) => this.saveObjective(e));

                // Task management
                document.getElementById('closeTaskModal').addEventListener('click', () => this.closeTaskModal());
                document.getElementById('cancelTaskBtn').addEventListener('click', () => this.closeTaskModal());
                document.getElementById('taskForm').addEventListener('submit', (e) => this.saveTask(e));

                // Settings
                document.getElementById('exportDataBtn')?.addEventListener('click', () => this.exportData());
                document.getElementById('importDataBtn')?.addEventListener('click', () => this.importData());
                document.getElementById('clearDataBtn')?.addEventListener('click', () => this.clearData());

                // Quotes controls
                document.getElementById('prevQuoteBtn')?.addEventListener('click', () => this.prevQuote());
                document.getElementById('nextQuoteBtn')?.addEventListener('click', () => this.nextQuote());
                document.getElementById('toggleQuotesBtn')?.addEventListener('click', () => this.toggleQuotes());

                // Search
                document.getElementById('globalSearch')?.addEventListener('input', (e) => {
                    this.searchContent(e.target.value);
                });
                document.getElementById('clearSearch')?.addEventListener('click', () => {
                    document.getElementById('globalSearch').value = '';
                    this.updateUI();
                });

                // Tutorial tip
                document.getElementById('closeTipBtn')?.addEventListener('click', () => this.hideTip());

                // Achievements
                document.getElementById('closeAchievementsModal')?.addEventListener('click', () => this.closeAchievementsModal());
                document.getElementById('closeAchievementsBtn')?.addEventListener('click', () => this.closeAchievementsModal());

                // Apply theme on load
                this.applyTheme();
                
                // Initialize YouTube music
                this.initializeYouTubeMusic();
            }

            initializeYouTubeMusic() {
                const iframe = document.getElementById('youtubeMusic');
                this.musicSettings.youtubePlayer = iframe;
                
                // Listen for YouTube player ready
                window.onYouTubeIframeAPIReady = () => {
                    console.log("YouTube API ready");
                };
            }

            updateMusic() {
                const iframe = this.musicSettings.youtubePlayer;
                if (!iframe) return;
                
                if (this.musicSettings.enabled) {
                    // Enable music by changing src to autoplay
                    iframe.src = "https://www.youtube.com/embed/jfKfPfyJRdk?si=Qo6CCOi9pXksg0X-&amp;controls=0&amp;autoplay=1&amp;mute=0";
                    iframe.style.display = 'block';
                } else {
                    // Disable music
                    iframe.src = "https://www.youtube.com/embed/jfKfPfyJRdk?si=Qo6CCOi9pXksg0X-&amp;controls=0&amp;autoplay=0";
                    iframe.style.display = 'none';
                }
            }

            updateMusicToggle() {
                const toggleBtn = document.getElementById('musicToggleBtn');
                const settingsToggle = document.getElementById('musicToggle');
                
                if (toggleBtn) {
                    toggleBtn.classList.toggle('active', this.musicSettings.enabled);
                    toggleBtn.innerHTML = `
                        <i class="fas fa-music"></i>
                        <span>${this.musicSettings.enabled ? 'Music On' : 'Music Off'}</span>
                    `;
                }
                
                if (settingsToggle) {
                    settingsToggle.checked = this.musicSettings.enabled;
                }
            }

            toggleMusic() {
                this.musicSettings.enabled = !this.musicSettings.enabled;
                this.saveData();
                this.updateMusic();
                this.updateMusicToggle();
                this.showNotification(this.musicSettings.enabled ? 'Music enabled' : 'Music disabled');
            }

            // Setup Steps
            nextStep() {
                const currentStep = document.querySelector('.setup-step.active');
                const isValid = this.validateStep(this.currentStep);
                
                if (!isValid) return;

                if (this.currentStep < 3) {
                    currentStep.classList.remove('active');
                    currentStep.classList.add('hidden');
                    
                    const nextStep = document.getElementById(`step${this.currentStep + 1}`);
                    nextStep.classList.remove('hidden');
                    nextStep.classList.add('active');
                    
                    // Update progress indicators
                    document.querySelectorAll('.progress-step').forEach((step, index) => {
                        if (index + 1 === this.currentStep) {
                            step.classList.remove('active');
                            step.classList.add('completed');
                        }
                        if (index + 1 === this.currentStep + 1) {
                            step.classList.add('active');
                        }
                    });

                    this.currentStep++;
                    
                    // Update buttons
                    document.getElementById('prevBtn').classList.remove('hidden');
                    if (this.currentStep === 3) {
                        document.getElementById('nextBtn').textContent = 'Get Started';
                    }
                } else {
                    this.completeSetup();
                }
            }

            prevStep() {
                if (this.currentStep > 1) {
                    const currentStep = document.querySelector('.setup-step.active');
                    currentStep.classList.remove('active');
                    currentStep.classList.add('hidden');
                    
                    const prevStep = document.getElementById(`step${this.currentStep - 1}`);
                    prevStep.classList.remove('hidden');
                    prevStep.classList.add('active');
                    
                    // Update progress indicators
                    document.querySelectorAll('.progress-step').forEach((step, index) => {
                        if (index + 1 === this.currentStep) {
                            step.classList.remove('active');
                        }
                        if (index + 1 === this.currentStep - 1) {
                            step.classList.add('active');
                            step.classList.remove('completed');
                        }
                    });

                    this.currentStep--;
                    
                    // Update buttons
                    if (this.currentStep === 1) {
                        document.getElementById('prevBtn').classList.add('hidden');
                    }
                    document.getElementById('nextBtn').textContent = 'Next Step';
                }
            }

            validateStep(step) {
                switch(step) {
                    case 1:
                        const name = document.getElementById('userName').value.trim();
                        const focus = document.getElementById('userFocus').value;
                        if (!name) {
                            alert('Please enter your name');
                            return false;
                        }
                        if (!focus) {
                            alert('Please select your focus area');
                            return false;
                        }
                        return true;
                    case 2:
                        const objective = document.getElementById('setupObjective').value.trim();
                        const task = document.getElementById('setupTask').value.trim();
                        if (!objective) {
                            alert('Please create your first objective');
                            return false;
                        }
                        if (!task) {
                            alert('Please create your first task');
                            return false;
                        }
                        return true;
                    case 3:
                        const workStyle = document.getElementById('workStyle').value;
                        const motivation = document.getElementById('motivationType').value;
                        if (!workStyle) {
                            alert('Please select your work style');
                            return false;
                        }
                        if (!motivation) {
                            alert('Please select your motivation type');
                            return false;
                        }
                        return true;
                    default:
                        return true;
                }
            }

            completeSetup() {
                this.settings.setupCompleted = true;
                this.settings.userName = document.getElementById('userName').value.trim();
                this.settings.userFocus = document.getElementById('userFocus').value;
                this.settings.workStyle = document.getElementById('workStyle').value;
                this.settings.motivationType = document.getElementById('motivationType').value;
                
                // Create first objective and task from setup
                const objectiveId = this.generateId();
                const objective = {
                    id: objectiveId,
                    title: document.getElementById('setupObjective').value.trim(),
                    description: "Your first objective created during setup",
                    category: "personal",
                    timeRange: "short",
                    priority: 3,
                    status: "active",
                    createdAt: new Date().toISOString()
                };
                
                const task = {
                    id: this.generateId(),
                    title: document.getElementById('setupTask').value.trim(),
                    description: "Your first task created during setup",
                    objectiveId: objectiveId,
                    deadline: new Date().toISOString().split('T')[0],
                    duration: 1,
                    importance: 3,
                    status: "not-started",
                    createdAt: new Date().toISOString()
                };
                
                this.objectives.push(objective);
                this.tasks.push(task);
                this.settings.activeObjective = objectiveId;
                
                this.saveData();
                document.getElementById('setupModal').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                this.updateUI();
                this.showNotification(`Welcome to FocusFlow, ${this.settings.userName}! You've created your first objective and task.`);
            }

            // Quotes System
            initQuotes() {
                this.currentQuoteIndex = Math.floor(Math.random() * this.quotes.length);
                this.updateQuoteDisplay();
            }

            nextQuote() {
                this.currentQuoteIndex = (this.currentQuoteIndex + 1) % this.quotes.length;
                this.updateQuoteDisplay();
            }

            prevQuote() {
                this.currentQuoteIndex = (this.currentQuoteIndex - 1 + this.quotes.length) % this.quotes.length;
                this.updateQuoteDisplay();
            }

            updateQuoteDisplay() {
                const quoteText = document.getElementById('currentQuote');
                const quoteAuthor = document.getElementById('quoteAuthor');
                if (quoteText && quoteAuthor) {
                    quoteText.textContent = this.quotes[this.currentQuoteIndex].text;
                    quoteAuthor.textContent = ` ${this.quotes[this.currentQuoteIndex].author}`;
                    quoteText.parentElement.classList.add('fade-in');
                    setTimeout(() => {
                        quoteText.parentElement.classList.remove('fade-in');
                    }, 500);
                }
            }

            toggleQuotes() {
                this.showQuotesBar = !this.showQuotesBar;
                const quotesBar = document.getElementById('quotesBar');
                const toggleBtn = document.getElementById('toggleQuotesBtn');
                
                if (quotesBar) {
                    quotesBar.style.display = this.showQuotesBar ? 'flex' : 'none';
                    if (toggleBtn) {
                        toggleBtn.innerHTML = `<i class="fas fa-eye${this.showQuotesBar ? '' : '-slash'}"></i>`;
                    }
                }
            }

            // Context Menu System
            initContextMenu() {
                document.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    const target = e.target.closest('.task-item, .objective-card');
                    if (target) {
                        this.showContextMenu(e, target);
                    }
                });

                document.addEventListener('click', () => {
                    this.hideContextMenu();
                });

                document.getElementById('contextMenu').addEventListener('click', (e) => {
                    const menuItem = e.target.closest('.context-menu-item');
                    if (menuItem && this.contextMenuTarget) {
                        const action = menuItem.dataset.action;
                        this.handleContextMenuAction(action, this.contextMenuTarget);
                    }
                });
            }

            showContextMenu(e, target) {
                e.preventDefault();
                this.contextMenuTarget = target;
                const menu = document.getElementById('contextMenu');
                
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';
                menu.classList.add('active');
            }

            hideContextMenu() {
                const menu = document.getElementById('contextMenu');
                menu.classList.remove('active');
                this.contextMenuTarget = null;
            }

            handleContextMenuAction(action, target) {
                const itemId = target.dataset.taskId || target.dataset.objectiveId;
                
                switch(action) {
                    case 'edit':
                        if (target.classList.contains('task-item')) {
                            this.editTask(itemId);
                        } else {
                            this.editObjective(itemId);
                        }
                        break;
                    case 'delete':
                        if (target.classList.contains('task-item')) {
                            this.deleteTask(itemId);
                        } else {
                            this.deleteObjective(itemId);
                        }
                        break;
                    case 'duplicate':
                        this.duplicateItem(itemId, target.classList.contains('task-item') ? 'task' : 'objective');
                        break;
                    case 'mark-done':
                        if (target.classList.contains('task-item')) {
                            this.toggleTaskCompletion(itemId);
                        }
                        break;
                }
                
                this.hideContextMenu();
            }

            // UI Methods
            switchSection(sectionId) {
                // Update navigation
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.section === sectionId);
                });

                // Update content bar title
                const titleMap = {
                    'dashboard': 'Dashboard',
                    'objectives': 'Objectives',
                    'tasks': 'Tasks',
                    'progress': 'Progress Analytics',
                    'calendar': 'Calendar',
                    'settings': 'Settings'
                };
                
                const iconMap = {
                    'dashboard': 'home',
                    'objectives': 'bullseye',
                    'tasks': 'tasks',
                    'progress': 'chart-line',
                    'calendar': 'calendar-alt',
                    'settings': 'cog'
                };
                
                document.getElementById('currentPageTitle').innerHTML = 
                    `<i class="fas fa-${iconMap[sectionId]}"></i> ${titleMap[sectionId]}`;

                // Show section
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.toggle('active', section.id === sectionId);
                });

                // Update section-specific content
                if (sectionId === 'dashboard') {
                    this.updateDashboard();
                } else if (sectionId === 'objectives') {
                    this.renderObjectives();
                } else if (sectionId === 'tasks') {
                    this.renderTasks();
                } else if (sectionId === 'progress') {
                    this.updateProgressStats();
                } else if (sectionId === 'calendar') {
                    this.renderCalendarSection();
                } else if (sectionId === 'settings') {
                    this.updateSettingsUI();
                }
            }

            updateDashboard() {
                // Update welcome message
                const now = new Date();
                const hour = now.getHours();
                let greeting = 'Good evening';
                if (hour < 12) greeting = 'Good morning';
                else if (hour < 18) greeting = 'Good afternoon';
                
                document.getElementById('welcomeMessage').textContent = `${greeting}, ${this.settings.userName}!`;
                document.getElementById('userAvatar').textContent = this.settings.userName.charAt(0).toUpperCase();
                document.getElementById('userFocusDisplay').textContent = `Focus Area: ${this.getFocusText(this.settings.userFocus)}`;
                
                // Update stats - Focus Today always 2 digits
                document.getElementById('dailyGoalDisplay').textContent = `${this.settings.dailyGoal || '0'}m`;
                document.getElementById('streakDisplay').textContent = this.settings.streak;
                document.getElementById('completedToday').textContent = this.settings.todayTasksCompleted || 0;
                document.getElementById('focusTimeToday').textContent = 
                    this.settings.todayFocusMinutes ? 
                    (this.settings.todayFocusMinutes < 10 ? '0' + this.settings.todayFocusMinutes : this.settings.todayFocusMinutes) : 
                    '00';

                // Update active objective
                const activeObjective = this.objectives.find(obj => obj.id === this.settings.activeObjective);
                const activeObjectiveContent = document.getElementById('activeObjectiveContent');
                const emptyObjective = document.getElementById('emptyObjective');
                
                if (activeObjective) {
                    emptyObjective.style.display = 'none';
                    activeObjectiveContent.innerHTML = `
                        <h3 style="margin-bottom: 10px;">${activeObjective.title}</h3>
                        <p class="text-muted" style="margin-bottom: 15px;">${activeObjective.description || 'No description'}</p>
                        <div class="objective-progress">
                            <div class="progress-label">
                                <span>Progress</span>
                                <span>${this.getObjectiveProgress(activeObjective.id)}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${this.getObjectiveProgress(activeObjective.id)}%"></div>
                            </div>
                        </div>
                    `;
                } else {
                    emptyObjective.style.display = 'block';
                    activeObjectiveContent.innerHTML = '';
                }

                // Update today's tasks
                const today = new Date().toISOString().split('T')[0];
                const todaysTasks = this.tasks.filter(task => task.deadline === today && task.status !== 'completed');
                const todayTasksContainer = document.getElementById('todayTasks');
                const emptyToday = document.getElementById('emptyToday');
                
                if (todaysTasks.length > 0) {
                    emptyToday.style.display = 'none';
                    todayTasksContainer.innerHTML = todaysTasks.map(task => `
                        <div class="task-item" data-task-id="${task.id}">
                            <div class="task-checkbox ${task.status === 'completed' ? 'checked' : ''}" onclick="app.toggleTaskCompletion('${task.id}')">
                                ${task.status === 'completed' ? '<i class="fas fa-check"></i>' : ''}
                            </div>
                            <div class="task-info">
                                <div class="task-title">${task.title}</div>
                                <div class="task-meta">
                                    <span><i class="far fa-clock"></i> ${task.duration}h</span>
                                    <span class="priority-${task.importance > 2 ? 'high' : task.importance > 1 ? 'medium' : 'low'}">
                                        <i class="fas fa-exclamation-circle"></i> ${this.getPriorityText(task.importance)}
                                    </span>
                                </div>
                            </div>
                            <button class="btn-icon" onclick="app.editTask('${task.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    `).join('');
                } else {
                    emptyToday.style.display = 'block';
                    todayTasksContainer.innerHTML = '';
                }

                // Update overall progress
                const overallProgress = this.getOverallProgress();
                document.getElementById('overallProgress').textContent = overallProgress + '%';
                document.getElementById('progressMessage').textContent = this.getProgressMessage(overallProgress);
                
                // Update progress ring
                const progressRing = document.querySelector('.progress-ring-fill');
                const circumference = 2 * Math.PI * 52;
                const offset = circumference - (overallProgress / 100) * circumference;
                progressRing.style.strokeDasharray = `${circumference} ${circumference}`;
                progressRing.style.strokeDashoffset = offset;

                // Render enhanced stats with clickable achievements
                this.renderEnhancedStats();

                // Render calendar
                this.renderDashboardCalendar();
            }

            renderEnhancedStats() {
                const statsGrid = document.getElementById('enhancedStats');
                if (!statsGrid) return;

                // Calculate real statistics
                const achievementScore = this.calculateAchievementScore();
                const efficiencyScore = this.calculateEfficiencyScore();
                const weeklyGrowth = this.calculateWeeklyGrowth();
                const focusConsistency = this.calculateFocusConsistency();

                statsGrid.innerHTML = `
                    <div class="stat-card" onclick="app.showAchievementsModal()">
                        <div class="stat-card-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="stat-card-value">${this.settings.streak}</div>
                        <div class="stat-card-label">Day Streak</div>
                        <div class="progress-indicator">
                            <div class="text-sm">${this.getStreakLevel()} level</div>
                            <div class="progress-level">
                                <div class="progress-level-fill" style="width: ${Math.min((this.settings.streak / 30) * 100, 100)}%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" onclick="app.showAchievementsModal()">
                        <div class="stat-card-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-card-value">${achievementScore}</div>
                        <div class="stat-card-label">Achievements</div>
                        <div class="progress-indicator">
                            <div class="text-sm">${this.achievements.filter(a => a.unlocked).length}/8 unlocked</div>
                            <div class="progress-level">
                                <div class="progress-level-fill" style="width: ${(this.achievements.filter(a => a.unlocked).length / 8) * 100}%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" onclick="app.showEfficiencyDetails()">
                        <div class="stat-card-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-card-value">${efficiencyScore}%</div>
                        <div class="stat-card-label">Efficiency</div>
                        <div class="progress-indicator">
                            <div class="text-sm">${this.getEfficiencyLevel(efficiencyScore)}</div>
                            <div class="progress-level">
                                <div class="progress-level-fill" style="width: ${efficiencyScore}%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card" onclick="app.showGrowthDetails()">
                        <div class="stat-card-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-card-value">+${weeklyGrowth}%</div>
                        <div class="stat-card-label">Weekly Growth</div>
                        <div class="progress-indicator">
                            <div class="text-sm">${this.getGrowthLevel(weeklyGrowth)}</div>
                            <div class="progress-level">
                                <div class="progress-level-fill" style="width: ${Math.min(weeklyGrowth, 100)}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            }

            showAchievementsModal() {
                const modal = document.getElementById('achievementsModal');
                const grid = document.getElementById('achievementsGrid');
                
                grid.innerHTML = this.achievements.map(achievement => `
                    <div class="achievement-item ${achievement.unlocked ? 'unlocked' : 'locked'}">
                        <div class="achievement-icon">
                            <i class="fas ${achievement.icon}"></i>
                        </div>
                        <div class="achievement-title">${achievement.title}</div>
                        <div class="achievement-desc">${achievement.description}</div>
                        <div class="text-sm mt-2 ${achievement.unlocked ? 'text-success' : 'text-muted'}">
                            ${achievement.unlocked ? ' Unlocked' : 'Locked'}
                        </div>
                    </div>
                `).join('');
                
                modal.classList.add('active');
            }

            closeAchievementsModal() {
                document.getElementById('achievementsModal').classList.remove('active');
            }

            showEfficiencyDetails() {
                const efficiency = this.calculateEfficiencyScore();
                const tasksCompleted = this.tasks.filter(t => t.status === 'completed').length;
                const totalTasks = this.tasks.length;
                const onTimeRate = totalTasks > 0 ? Math.round((tasksCompleted / totalTasks) * 100) : 0;
                
                alert(`Efficiency Details:\n\n Efficiency Score: ${efficiency}%\n Tasks Completed: ${tasksCompleted}/${totalTasks}\n On-time Completion Rate: ${onTimeRate}%\n Focus Sessions: ${this.settings.focusSessions.length}\n Average Session: ${this.settings.focusSessions.length > 0 ? (this.settings.totalFocusHours / this.settings.focusSessions.length).toFixed(1) : '0'} hours`);
            }

            showGrowthDetails() {
                const growth = this.calculateWeeklyGrowth();
                const consistency = this.calculateFocusConsistency();
                
                alert(`Growth Details:\n\n Weekly Growth: +${growth}%\n Focus Consistency: ${consistency}%\n Current Streak: ${this.settings.streak} days\n Total Focus Hours: ${this.settings.totalFocusHours.toFixed(1)}\n Tasks Completed: ${this.tasks.filter(t => t.status === 'completed').length}`);
            }

            calculateAchievementScore() {
                return this.achievements.filter(a => a.unlocked).length;
            }

            calculateEfficiencyScore() {
                if (this.tasks.length === 0) return 0;
                
                const completedTasks = this.tasks.filter(t => t.status === 'completed').length;
                const totalTasks = this.tasks.length;
                const baseEfficiency = Math.round((completedTasks / totalTasks) * 60);
                
                // Add bonus for timely completion
                let bonus = 0;
                const today = new Date().toISOString().split('T')[0];
                const overdueTasks = this.tasks.filter(t => t.deadline < today && t.status !== 'completed').length;
                const onTimeTasks = this.tasks.filter(t => t.deadline >= today && t.status === 'completed').length;
                
                if (totalTasks > 0) {
                    bonus = Math.round((onTimeTasks / totalTasks) * 40) - Math.round((overdueTasks / totalTasks) * 20);
                }
                
                return Math.max(0, Math.min(100, baseEfficiency + bonus));
            }

            calculateWeeklyGrowth() {
                const today = new Date();
                const lastWeek = new Date(today);
                lastWeek.setDate(today.getDate() - 7);
                
                const lastWeekSessions = this.settings.focusSessions.filter(session => {
                    const sessionDate = new Date(session.date);
                    return sessionDate >= lastWeek && sessionDate < today;
                });
                
                const twoWeeksAgo = new Date(today);
                twoWeeksAgo.setDate(today.getDate() - 14);
                
                const previousWeekSessions = this.settings.focusSessions.filter(session => {
                    const sessionDate = new Date(session.date);
                    return sessionDate >= twoWeeksAgo && sessionDate < lastWeek;
                });
                
                const lastWeekMinutes = lastWeekSessions.reduce((total, session) => total + (session.duration * 60), 0);
                const previousWeekMinutes = previousWeekSessions.reduce((total, session) => total + (session.duration * 60), 0);
                
                if (previousWeekMinutes === 0) {
                    return lastWeekMinutes > 0 ? 100 : 0;
                }
                
                const growth = ((lastWeekMinutes - previousWeekMinutes) / previousWeekMinutes) * 100;
                return Math.round(Math.max(0, growth));
            }

            calculateFocusConsistency() {
                const last7Days = [];
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    last7Days.push(date.toISOString().split('T')[0]);
                }
                
                const daysWithFocus = last7Days.filter(date => {
                    return this.settings.focusSessions.some(session => session.date === date);
                }).length;
                
                return Math.round((daysWithFocus / 7) * 100);
            }

            getStreakLevel() {
                if (this.settings.streak >= 30) return "Legendary";
                if (this.settings.streak >= 21) return "Expert";
                if (this.settings.streak >= 14) return "Advanced";
                if (this.settings.streak >= 7) return "Intermediate";
                return "Beginner";
            }

            getEfficiencyLevel(score) {
                if (score >= 90) return "Exceptional";
                if (score >= 75) return "Excellent";
                if (score >= 60) return "Good";
                if (score >= 40) return "Fair";
                return "Needs Improvement";
            }

            getGrowthLevel(growth) {
                if (growth >= 50) return "Rapid";
                if (growth >= 25) return "Steady";
                if (growth >= 10) return "Slow";
                if (growth > 0) return "Minimal";
                return "Stagnant";
            }

            renderDashboardCalendar() {
                const calendar = document.getElementById('weekCalendar');
                if (!calendar) return;
                
                const today = new Date();
                const startOfWeek = new Date(today);
                startOfWeek.setDate(today.getDate() - today.getDay());
                
                calendar.innerHTML = '';
                
                for (let i = 0; i < 7; i++) {
                    const dayDate = new Date(startOfWeek);
                    dayDate.setDate(startOfWeek.getDate() + i);
                    const dayStr = dayDate.toISOString().split('T')[0];
                    
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'calendar-day';
                    dayDiv.textContent = dayDate.getDate();
                    
                    // Check for events
                    const dayEvents = this.getEventsForDate(dayStr);
                    const dayTasks = this.tasks.filter(task => task.deadline === dayStr);
                    const dayObjectives = this.objectives.filter(obj => obj.deadline === dayStr);
                    
                    if (dayEvents.length > 0) {
                        dayDiv.classList.add('has-event');
                        const indicator = document.createElement('div');
                        indicator.className = 'event-indicator';
                        dayDiv.appendChild(indicator);
                    }
                    
                    if (dayTasks.length > 0) {
                        dayDiv.classList.add('has-task');
                        const indicator = document.createElement('div');
                        indicator.className = 'event-indicator task-indicator';
                        dayDiv.appendChild(indicator);
                    }
                    
                    if (dayObjectives.length > 0) {
                        dayDiv.classList.add('has-objective');
                        const indicator = document.createElement('div');
                        indicator.className = 'event-indicator objective-indicator';
                        dayDiv.appendChild(indicator);
                    }
                    
                    const hasActivity = this.settings.focusSessions.some(session => 
                        session.date === dayStr
                    );
                    
                    const isToday = dayDate.toDateString() === today.toDateString();
                    
                    if (hasActivity) {
                        dayDiv.style.background = 'var(--secondary)';
                        dayDiv.style.color = 'white';
                    } else if (isToday) {
                        dayDiv.style.border = '2px solid var(--primary)';
                    }
                    
                    let title = dayDate.toLocaleDateString();
                    if (dayEvents.length > 0) title += ` - ${dayEvents.length} event(s)`;
                    if (dayTasks.length > 0) title += ` - ${dayTasks.length} task(s)`;
                    if (dayObjectives.length > 0) title += ` - ${dayObjectives.length} objective(s)`;
                    
                    dayDiv.title = title;
                    dayDiv.onclick = () => this.viewDayDetails(dayStr);
                    
                    calendar.appendChild(dayDiv);
                }
            }

            renderCalendarSection() {
                const container = document.getElementById('calendarMonthView');
                if (!container) return;
                
                const today = new Date();
                const firstDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), 1);
                const lastDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth() + 1, 0);
                const firstDayIndex = firstDay.getDay();
                const lastDayIndex = lastDay.getDay();
                const prevMonthLastDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), 0).getDate();
                
                const monthNames = ["January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"];
                
                let html = `
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-bold">${monthNames[this.calendarDate.getMonth()]} ${this.calendarDate.getFullYear()}</h3>
                        <div class="flex gap-2">
                            <button class="btn btn-secondary btn-sm" onclick="app.prevMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="app.nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="app.todayMonth()">
                                Today
                            </button>
                        </div>
                    </div>
                    <div class="calendar-header">
                        <div>Sun</div>
                        <div>Mon</div>
                        <div>Tue</div>
                        <div>Wed</div>
                        <div>Thu</div>
                        <div>Fri</div>
                        <div>Sat</div>
                    </div>
                    <div class="calendar-view">
                `;
                
                // Previous month days
                for (let i = firstDayIndex; i > 0; i--) {
                    const dayDate = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth() - 1, prevMonthLastDay - i + 1);
                    const dayStr = dayDate.toISOString().split('T')[0];
                    html += `<div class="calendar-day text-muted">${prevMonthLastDay - i + 1}</div>`;
                }
                
                // Current month days
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    const dayDate = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), i);
                    const dayStr = dayDate.toISOString().split('T')[0];
                    const isToday = dayDate.toDateString() === today.toDateString();
                    
                    const dayEvents = this.getEventsForDate(dayStr);
                    const dayTasks = this.tasks.filter(task => task.deadline === dayStr);
                    const dayObjectives = this.objectives.filter(obj => obj.deadline === dayStr);
                    
                    let dayClass = 'calendar-day';
                    if (isToday) dayClass += ' active';
                    
                    let indicators = '';
                    if (dayEvents.length > 0) indicators += '<div class="event-indicator"></div>';
                    if (dayTasks.length > 0) indicators += '<div class="event-indicator task-indicator"></div>';
                    if (dayObjectives.length > 0) indicators += '<div class="event-indicator objective-indicator"></div>';
                    
                    html += `
                        <div class="${dayClass}" onclick="app.openDayEvents('${dayStr}')">
                            ${i}
                            ${indicators}
                        </div>
                    `;
                }
                
                // Next month days
                const nextDays = 7 - lastDayIndex - 1;
                for (let i = 1; i <= nextDays; i++) {
                    html += `<div class="calendar-day text-muted">${i}</div>`;
                }
                
                html += '</div>';
                container.innerHTML = html;
            }

            getEventsForDate(date) {
                return this.calendarEvents.filter(event => event.date === date);
            }

            getFocusText(focus) {
                const focusMap = {
                    'academic': 'Academic & Study',
                    'career': 'Career & Professional',
                    'creative': 'Creative Projects',
                    'entrepreneur': 'Entrepreneurship',
                    'personal': 'Personal Development',
                    'fitness': 'Health & Fitness',
                    'other': 'Other'
                };
                return focusMap[focus] || 'Not set';
            }

            renderObjectives() {
                const container = document.getElementById('objectivesList');
                if (!container) return;

                if (this.objectives.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-bullseye"></i>
                            <h3>No objectives yet</h3>
                            <p>Create your first objective to get started</p>
                            <button class="btn btn-primary mt-3" onclick="app.openObjectiveModal()">
                                Create Objective
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.objectives.map(obj => `
                    <div class="objective-card card" data-objective-id="${obj.id}">
                        <div class="card-header">
                            <h3 class="card-title">${obj.title}</h3>
                            <span class="status-badge status-${obj.status}">${obj.status.charAt(0).toUpperCase() + obj.status.slice(1)}</span>
                        </div>
                        <p class="text-muted">${obj.description || 'No description'}</p>
                        <div class="mt-4">
                            <div class="flex justify-between text-sm">
                                <span><i class="fas fa-tag"></i> ${this.getCategoryText(obj.category)}</span>
                                <span><i class="fas fa-flag"></i> ${this.getTimeRangeText(obj.timeRange)}</span>
                            </div>
                            <div class="objective-progress mt-4">
                                <div class="progress-label">
                                    <span>Progress</span>
                                    <span>${this.getObjectiveProgress(obj.id)}%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${this.getObjectiveProgress(obj.id)}%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-between mt-4">
                            <button class="btn btn-secondary btn-sm" onclick="app.editObjective('${obj.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="btn ${obj.id === this.settings.activeObjective ? 'btn-success' : 'btn-primary'} btn-sm" 
                                    onclick="app.setActiveObjective('${obj.id}')">
                                <i class="fas fa-star"></i> ${obj.id === this.settings.activeObjective ? 'Active' : 'Set Active'}
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            renderTasks() {
                const container = document.getElementById('tasksList');
                if (!container) return;

                if (this.tasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-tasks"></i>
                            <h3>No tasks yet</h3>
                            <p>Create your first task to get started</p>
                            <button class="btn btn-primary mt-3" onclick="app.openTaskModal()">
                                Create Task
                            </button>
                        </div>
                    `;
                    return;
                }

                // Group tasks by status
                const notStarted = this.tasks.filter(t => t.status === 'not-started');
                const inProgress = this.tasks.filter(t => t.status === 'in-progress');
                const completed = this.tasks.filter(t => t.status === 'completed');

                let html = '';

                if (inProgress.length > 0) {
                    html += `<h3 class="font-bold mb-3">In Progress</h3>`;
                    html += inProgress.map(task => this.createTaskHtml(task)).join('');
                }

                if (notStarted.length > 0) {
                    html += `<h3 class="font-bold mb-3 mt-6">Not Started</h3>`;
                    html += notStarted.map(task => this.createTaskHtml(task)).join('');
                }

                if (completed.length > 0) {
                    html += `<h3 class="font-bold mb-3 mt-6">Completed</h3>`;
                    html += completed.map(task => this.createTaskHtml(task)).join('');
                }

                container.innerHTML = html;
            }

            createTaskHtml(task) {
                const objective = this.objectives.find(o => o.id === task.objectiveId);
                return `
                    <div class="task-item" data-task-id="${task.id}">
                        <div class="task-checkbox ${task.status === 'completed' ? 'checked' : ''}" onclick="app.toggleTaskCompletion('${task.id}')">
                            ${task.status === 'completed' ? '<i class="fas fa-check"></i>' : ''}
                        </div>
                        <div class="task-info">
                            <div class="task-title">${task.title}</div>
                            <div class="task-meta">
                                <span><i class="far fa-clock"></i> ${task.duration}h</span>
                                <span><i class="fas fa-calendar"></i> ${new Date(task.deadline).toLocaleDateString()}</span>
                                <span class="priority-${task.importance > 2 ? 'high' : task.importance > 1 ? 'medium' : 'low'}">
                                    <i class="fas fa-exclamation-circle"></i> ${this.getPriorityText(task.importance)}
                                </span>
                                ${objective ? `<span><i class="fas fa-bullseye"></i> ${objective.title}</span>` : ''}
                            </div>
                        </div>
                        <div>
                            <button class="btn-icon" onclick="app.editTask('${task.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="app.deleteTask('${task.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }

            updateProgressStats() {
                const completedTasks = this.tasks.filter(t => t.status === 'completed').length;
                const totalTasks = this.tasks.length;
                const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                
                document.getElementById('completedTasks').textContent = completedTasks;
                document.getElementById('totalHours').textContent = this.settings.totalFocusHours.toFixed(1);
                document.getElementById('completionRate').textContent = completionRate + '%';
                
                this.generateHeatmap();
            }

            generateHeatmap() {
                const heatmap = document.getElementById('heatmap');
                if (!heatmap) return;
                
                heatmap.innerHTML = '';
                
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    
                    const hasActivity = this.settings.focusSessions.some(session => 
                        session.date === dateStr
                    );
                    
                    const day = document.createElement('div');
                    day.style.width = '20px';
                    day.style.height = '20px';
                    day.style.borderRadius = '4px';
                    day.style.backgroundColor = hasActivity ? 'var(--secondary)' : 'var(--border)';
                    day.style.opacity = hasActivity ? '0.8' : '0.3';
                    day.title = date.toLocaleDateString() + (hasActivity ? ' - Active' : ' - No activity');
                    
                    heatmap.appendChild(day);
                }
            }

            updateSettingsUI() {
                document.getElementById('darkModeToggle').checked = this.settings.darkMode;
                document.getElementById('musicToggle').checked = this.musicSettings.enabled;
                
                document.getElementById('userNameDisplay').textContent = this.settings.userName || 'Not set';
                document.getElementById('focusAreaDisplay').textContent = this.getFocusText(this.settings.userFocus);
                document.getElementById('workStyleDisplay').textContent = this.settings.workStyle === 'pomodoro' ? 'Pomodoro' : 
                    this.settings.workStyle === 'deep' ? 'Deep Work' : 
                    this.settings.workStyle === 'timeblocking' ? 'Time Blocking' : 'Flexible';
                
                document.getElementById('focusDurationDisplay').textContent = `${this.timerSettings.focusDuration} minutes`;
                document.getElementById('breakDurationDisplay').textContent = `${this.timerSettings.breakDuration} minutes`;
                document.getElementById('timerDisplayMode').textContent = this.timerSettings.use24hFormat ? '24-hour format' : '12-hour format';
                
                this.applyTheme();
                this.updateMusicToggle();
            }

            // Theme Methods
            toggleTheme() {
                this.settings.darkMode = !this.settings.darkMode;
                this.saveData();
                this.applyTheme();
                this.showNotification(this.settings.darkMode ? 'Dark mode enabled' : 'Light mode enabled');
            }

            applyTheme() {
                if (this.settings.darkMode) {
                    document.body.classList.add('dark-mode');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    document.body.classList.remove('dark-mode');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-moon"></i>';
                }
            }

            // Music Methods
            connectSpotify() {
                this.showNotification("Spotify integration coming soon! For now, enjoy the built-in lo-fi music.");
            }

            // Grind Zone Methods
            openGrindZone() {
                const grindZone = document.getElementById('grindZone');
                grindZone.classList.add('active');
                grindZone.className = `grind-zone active ${this.grindSettings.background}`;
                
                // Apply timer display mode
                if (this.timerSettings.use24hFormat) {
                    grindZone.classList.add('timer-mode-24h');
                    grindZone.classList.remove('timer-mode-12h');
                } else {
                    grindZone.classList.remove('timer-mode-24h');
                    grindZone.classList.add('timer-mode-12h');
                }
                
                // Load active task
                const today = new Date().toISOString().split('T')[0];
                const todaysTasks = this.tasks.filter(task => task.deadline === today && task.status !== 'completed');
                if (todaysTasks.length > 0) {
                    document.getElementById('grindTask').textContent = todaysTasks[0].title;
                }
                
                // Reset timer
                this.timer.minutes = this.timerSettings.focusDuration;
                this.timer.seconds = 0;
                this.timer.running = false;
                this.timer.totalSeconds = this.timer.minutes * 60;
                this.timer.isFocus = true;
                this.updateTimerDisplay();
                
                // Update session info
                document.getElementById('grindSessionInfo').textContent = 'Focus Session';
                
                // Update music toggle
                this.updateMusicToggle();
            }

            closeGrindZone() {
                document.getElementById('grindZone').classList.remove('active');
                this.closeBackgroundPanel();
                this.stopTimer();
                // Stop music when leaving grind zone
                this.musicSettings.enabled = false;
                this.updateMusic();
            }

            toggleBackgroundPanel() {
                document.getElementById('backgroundPanel').classList.toggle('active');
            }
            
            closeBackgroundPanel() {
                document.getElementById('backgroundPanel').classList.remove('active');
            }

            selectBackground(bg) {
                this.grindSettings.background = bg;
                this.saveData();
                
                document.querySelectorAll('.background-option').forEach(option => {
                    option.classList.toggle('active', option.dataset.bg === bg);
                });
                
                const grindZone = document.getElementById('grindZone');
                grindZone.className = `grind-zone active ${bg}`;
                
                this.showNotification(`Background changed to ${bg}`);
            }

            // Timer Settings Methods
            openTimerSettings() {
                const modal = document.getElementById('timerSettingsModal');
                document.getElementById('focusDuration').value = this.timerSettings.focusDuration;
                document.getElementById('breakDuration').value = this.timerSettings.breakDuration;
                document.getElementById('timer24hToggle').checked = this.timerSettings.use24hFormat;
                modal.classList.add('active');
            }

            closeTimerSettings() {
                document.getElementById('timerSettingsModal').classList.remove('active');
            }

            saveTimerSettings(e) {
                e.preventDefault();
                
                this.timerSettings.focusDuration = parseInt(document.getElementById('focusDuration').value);
                this.timerSettings.breakDuration = parseInt(document.getElementById('breakDuration').value);
                this.timerSettings.use24hFormat = document.getElementById('timer24hToggle').checked;
                
                // Update current timer if it's not running
                if (!this.timer.running) {
                    this.timer.minutes = this.timerSettings.focusDuration;
                    this.timer.totalSeconds = this.timer.minutes * 60;
                    this.updateTimerDisplay();
                }
                
                // Update grind zone display mode
                const grindZone = document.getElementById('grindZone');
                if (this.timerSettings.use24hFormat) {
                    grindZone.classList.add('timer-mode-24h');
                    grindZone.classList.remove('timer-mode-12h');
                } else {
                    grindZone.classList.remove('timer-mode-24h');
                    grindZone.classList.add('timer-mode-12h');
                }
                
                localStorage.setItem('focusFlow_timerSettings', JSON.stringify(this.timerSettings));
                this.closeTimerSettings();
                this.updateSettingsUI();
                this.showNotification('Timer settings updated');
            }

            // Timer Methods with Animations
            startTimer() {
                if (!this.timer.running) {
                    this.timer.running = true;
                    this.timer.interval = setInterval(() => this.updateTimer(), 1000);
                    document.getElementById('startTimerBtn').disabled = true;
                    document.getElementById('pauseTimerBtn').disabled = false;
                    this.showNotification('Focus session started!');
                }
            }

            pauseTimer() {
                if (this.timer.running) {
                    this.timer.running = false;
                    clearInterval(this.timer.interval);
                    document.getElementById('startTimerBtn').disabled = false;
                    document.getElementById('pauseTimerBtn').disabled = true;
                    this.showNotification('Session paused');
                }
            }

            stopTimer() {
                if (this.timer.running) {
                    this.pauseTimer();
                    // Record session
                    const minutesFocused = (this.timer.isFocus ? this.timerSettings.focusDuration : this.timerSettings.breakDuration) - 
                                        (this.timer.minutes + this.timer.seconds / 60);
                    if (minutesFocused > 0 && this.timer.isFocus) {
                        this.recordFocusSession(minutesFocused);
                    }
                }
                this.timer.minutes = this.timer.isFocus ? this.timerSettings.focusDuration : this.timerSettings.breakDuration;
                this.timer.seconds = 0;
                this.timer.totalSeconds = this.timer.minutes * 60;
                this.updateTimerDisplay();
                this.showNotification('Session ended');
            }

            updateTimer() {
                this.timer.totalSeconds--;
                this.timer.minutes = Math.floor(this.timer.totalSeconds / 60);
                this.timer.seconds = this.timer.totalSeconds % 60;
                
                if (this.timer.totalSeconds <= 0) {
                    // Switch between focus and break
                    this.timer.isFocus = !this.timer.isFocus;
                    this.timer.minutes = this.timer.isFocus ? this.timerSettings.focusDuration : this.timerSettings.breakDuration;
                    this.timer.totalSeconds = this.timer.minutes * 60;
                    
                    if (this.timer.isFocus) {
                        this.showNotification('Break finished! Time to focus.');
                        document.getElementById('grindSessionInfo').textContent = 'Focus Session';
                    } else {
                        this.showNotification('Focus session finished! Time for a break.');
                        document.getElementById('grindSessionInfo').textContent = 'Break Session';
                        // Record focus session
                        this.recordFocusSession(this.timerSettings.focusDuration);
                        // Start break automatically
                        this.startBreak();
                    }
                    
                    this.updateTimerDisplay();
                    return;
                }
                
                this.updateTimerDisplay();
            }

            updateTimerDisplay() {
                const display = document.getElementById('grindTimer');
                const grindZone = document.getElementById('grindZone');
                
                if (this.timerSettings.use24hFormat) {
                    // 24-hour format
                    const mins = this.timer.minutes.toString().padStart(2, '0');
                    const secs = this.timer.seconds.toString().padStart(2, '0');
                    display.textContent = `${mins}:${secs}`;
                    display.classList.remove('pm');
                } else {
                    // 12-hour format
                    let hours = this.timer.minutes;
                    let minutes = this.timer.seconds;
                    let ampm = 'AM';
                    
                    if (hours >= 12) {
                        ampm = 'PM';
                        if (hours > 12) hours -= 12;
                    }
                    
                    const mins = hours.toString().padStart(2, '0');
                    const secs = minutes.toString().padStart(2, '0');
                    display.textContent = `${mins}:${secs}`;
                    display.className = `timer ${ampm.toLowerCase()}`;
                }
            }

            recordFocusSession(minutes) {
                const today = new Date().toISOString().split('T')[0];
                const hours = minutes / 60;
                
                this.settings.totalFocusHours += hours;
                this.settings.todayFocusMinutes = (this.settings.todayFocusMinutes || 0) + minutes;
                
                this.settings.focusSessions.push({
                    date: today,
                    duration: hours,
                    timestamp: new Date().toISOString()
                });
                
                // Update achievements
                this.updateAchievements();
                
                this.saveData();
                this.updateDashboard();
            }

            animateButton(button) {
                button.classList.add('bounce');
                setTimeout(() => {
                    button.classList.remove('bounce');
                }, 500);
            }

            // Break Methods
            startBreak() {
                this.breakTimer.minutes = this.timerSettings.breakDuration;
                this.breakTimer.seconds = 0;
                this.breakTimer.totalSeconds = this.timerSettings.breakDuration * 60;
                this.breakTimer.running = true;
                
                document.getElementById('breakZone').classList.add('active');
                document.getElementById('breakMessage').textContent = "Take a deep breath and relax...";
                document.getElementById('breakEndMessage').textContent = "";
                
                this.breakTimer.interval = setInterval(() => this.updateBreakTimer(), 1000);
                this.updateBreakTimerDisplay();
                
                this.showNotification("Break started! Relax and recharge.");
            }

            updateBreakTimer() {
                this.breakTimer.totalSeconds--;
                this.breakTimer.minutes = Math.floor(this.breakTimer.totalSeconds / 60);
                this.breakTimer.seconds = this.breakTimer.totalSeconds % 60;
                
                if (this.breakTimer.totalSeconds <= 0) {
                    this.finishBreakTimer();
                    return;
                }
                
                this.updateBreakTimerDisplay();
            }

            updateBreakTimerDisplay() {
                const display = document.getElementById('breakTimer');
                const mins = this.breakTimer.minutes.toString().padStart(2, '0');
                const secs = this.breakTimer.seconds.toString().padStart(2, '0');
                display.textContent = `${mins}:${secs}`;
            }

            finishBreakTimer() {
                clearInterval(this.breakTimer.interval);
                this.breakTimer.running = false;
                
                // Select random end message
                const randomMessage = this.breakMessages[Math.floor(Math.random() * this.breakMessages.length)];
                document.getElementById('breakEndMessage').textContent = randomMessage;
                
                this.showNotification("Break finished! " + randomMessage);
            }

            finishBreak() {
                clearInterval(this.breakTimer.interval);
                document.getElementById('breakZone').classList.remove('active');
                this.breakTimer.running = false;
                this.showNotification("Back to work!");
            }

            // Calendar Methods
            viewFullCalendar() {
                this.renderFullCalendar();
                document.getElementById('fullCalendarModal').classList.add('active');
            }

            closeFullCalendar() {
                document.getElementById('fullCalendarModal').classList.remove('active');
            }

            renderFullCalendar() {
                const container = document.getElementById('fullCalendarDays');
                const monthLabel = document.getElementById('fullCalendarMonth');
                
                const today = new Date();
                const firstDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), 1);
                const lastDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth() + 1, 0);
                const firstDayIndex = firstDay.getDay();
                const lastDayIndex = lastDay.getDay();
                const prevMonthLastDay = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), 0).getDate();
                
                const monthNames = ["January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"];
                
                monthLabel.textContent = `${monthNames[this.calendarDate.getMonth()]} ${this.calendarDate.getFullYear()}`;
                
                container.innerHTML = '';
                
                // Previous month days
                for (let i = firstDayIndex; i > 0; i--) {
                    const dayDate = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth() - 1, prevMonthLastDay - i + 1);
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'full-calendar-day text-muted';
                    dayDiv.innerHTML = `
                        <div class="full-calendar-day-header">${prevMonthLastDay - i + 1}</div>
                    `;
                    container.appendChild(dayDiv);
                }
                
                // Current month days
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    const dayDate = new Date(this.calendarDate.getFullYear(), this.calendarDate.getMonth(), i);
                    const dayStr = dayDate.toISOString().split('T')[0];
                    const isToday = dayDate.toDateString() === today.toDateString();
                    
                    const dayEvents = this.getEventsForDate(dayStr);
                    const dayTasks = this.tasks.filter(task => task.deadline === dayStr);
                    const dayObjectives = this.objectives.filter(obj => obj.deadline === dayStr);
                    
                    const dayDiv = document.createElement('div');
                    dayDiv.className = `full-calendar-day ${isToday ? 'today' : ''}`;
                    dayDiv.onclick = () => this.openDayEvents(dayStr);
                    
                    let eventsHtml = '';
                    
                    // Add task deadlines
                    dayTasks.forEach(task => {
                        eventsHtml += `
                            <div class="calendar-event-item calendar-event-task" onclick="app.editTask('${task.id}')">
                                <i class="fas fa-tasks"></i> ${task.title}
                            </div>
                        `;
                    });
                    
                    // Add objective deadlines
                    dayObjectives.forEach(obj => {
                        eventsHtml += `
                            <div class="calendar-event-item calendar-event-objective" onclick="app.editObjective('${obj.id}')">
                                <i class="fas fa-bullseye"></i> ${obj.title}
                            </div>
                        `;
                    });
                    
                    // Add custom events
                    dayEvents.forEach(event => {
                        eventsHtml += `
                            <div class="calendar-event-item calendar-event-custom" onclick="app.editCalendarEvent('${event.id}')">
                                <i class="fas fa-calendar"></i> ${event.title}
                            </div>
                        `;
                    });
                    
                    dayDiv.innerHTML = `
                        <div class="full-calendar-day-header">${i}</div>
                        <div class="calendar-events-list">
                            ${eventsHtml}
                        </div>
                    `;
                    
                    container.appendChild(dayDiv);
                }
                
                // Next month days
                const nextDays = 7 - lastDayIndex - 1;
                for (let i = 1; i <= nextDays; i++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'full-calendar-day text-muted';
                    dayDiv.innerHTML = `
                        <div class="full-calendar-day-header">${i}</div>
                    `;
                    container.appendChild(dayDiv);
                }
            }

            prevMonth() {
                this.calendarDate.setMonth(this.calendarDate.getMonth() - 1);
                this.renderFullCalendar();
                this.renderCalendarSection();
            }

            nextMonth() {
                this.calendarDate.setMonth(this.calendarDate.getMonth() + 1);
                this.renderFullCalendar();
                this.renderCalendarSection();
            }

            todayMonth() {
                this.calendarDate = new Date();
                this.renderFullCalendar();
                this.renderCalendarSection();
            }

            openDayEvents(date) {
                const dayDate = new Date(date);
                const dayEvents = this.getEventsForDate(date);
                const dayTasks = this.tasks.filter(task => task.deadline === date);
                const dayObjectives = this.objectives.filter(obj => obj.deadline === date);
                
                let message = `Events for ${dayDate.toLocaleDateString()}:\n\n`;
                
                if (dayTasks.length > 0) {
                    message += "Tasks:\n";
                    dayTasks.forEach(task => {
                        message += `- ${task.title} (${task.status})\n`;
                    });
                    message += "\n";
                }
                
                if (dayObjectives.length > 0) {
                    message += "Objectives:\n";
                    dayObjectives.forEach(obj => {
                        message += `- ${obj.title} (${obj.status})\n`;
                    });
                    message += "\n";
                }
                
                if (dayEvents.length > 0) {
                    message += "Events:\n";
                    dayEvents.forEach(event => {
                        message += `- ${event.title}\n`;
                    });
                }
                
                if (dayTasks.length === 0 && dayObjectives.length === 0 && dayEvents.length === 0) {
                    message += "No events scheduled for this day.";
                }
                
                alert(message);
            }

            // Calendar Event Methods
            openCalendarEventModal(eventId = null) {
                const modal = document.getElementById('calendarEventModal');
                const today = new Date().toISOString().split('T')[0];
                
                // Populate task dropdown
                const taskSelect = document.getElementById('linkedTask');
                taskSelect.innerHTML = '<option value="">Select task</option>' +
                    this.tasks.map(task => 
                        `<option value="${task.id}">${task.title}</option>`
                    ).join('');
                
                // Populate objective dropdown
                const objectiveSelect = document.getElementById('linkedObjective');
                objectiveSelect.innerHTML = '<option value="">Select objective</option>' +
                    this.objectives.map(obj => 
                        `<option value="${obj.id}">${obj.title}</option>`
                    ).join('');
                
                if (eventId) {
                    const event = this.calendarEvents.find(e => e.id === eventId);
                    if (event) {
                        document.getElementById('calendarEventModalTitle').textContent = 'Edit Calendar Event';
                        document.getElementById('calendarEventId').value = event.id;
                        document.getElementById('eventTitle').value = event.title;
                        document.getElementById('eventDescription').value = event.description || '';
                        document.getElementById('eventType').value = event.type;
                        document.getElementById('eventDate').value = event.date;
                        document.getElementById('eventTime').value = event.time || '';
                        document.getElementById('eventColor').value = event.color || '#4A90E2';
                        document.getElementById('eventPriority').value = event.priority || '2';
                        
                        if (event.linkedTaskId) {
                            document.getElementById('linkedTask').value = event.linkedTaskId;
                        }
                        if (event.linkedObjectiveId) {
                            document.getElementById('linkedObjective').value = event.linkedObjectiveId;
                        }
                        
                        this.handleEventTypeChange({ target: document.getElementById('eventType') });
                    }
                } else {
                    document.getElementById('calendarEventModalTitle').textContent = 'Add Calendar Event';
                    document.getElementById('calendarEventForm').reset();
                    document.getElementById('calendarEventId').value = '';
                    document.getElementById('eventDate').value = today;
                    document.getElementById('eventTime').value = '';
                    
                    if (this.selectedCalendarDate) {
                        document.getElementById('eventDate').value = this.selectedCalendarDate;
                    }
                }
                
                modal.classList.add('active');
            }

            closeCalendarEventModal() {
                document.getElementById('calendarEventModal').classList.remove('active');
            }

            handleEventTypeChange(e) {
                const type = e.target.value;
                const taskGroup = document.getElementById('linkedTaskGroup');
                const objectiveGroup = document.getElementById('linkedObjectiveGroup');
                
                if (type === 'task') {
                    taskGroup.style.display = 'block';
                    objectiveGroup.style.display = 'none';
                } else if (type === 'objective') {
                    taskGroup.style.display = 'none';
                    objectiveGroup.style.display = 'block';
                } else {
                    taskGroup.style.display = 'none';
                    objectiveGroup.style.display = 'none';
                }
            }

            saveCalendarEvent(e) {
                e.preventDefault();
                
                const event = {
                    id: document.getElementById('calendarEventId').value || this.generateId(),
                    title: document.getElementById('eventTitle').value,
                    description: document.getElementById('eventDescription').value,
                    type: document.getElementById('eventType').value,
                    date: document.getElementById('eventDate').value,
                    time: document.getElementById('eventTime').value || null,
                    color: document.getElementById('eventColor').value,
                    priority: parseInt(document.getElementById('eventPriority').value),
                    linkedTaskId: document.getElementById('eventType').value === 'task' ? document.getElementById('linkedTask').value : null,
                    linkedObjectiveId: document.getElementById('eventType').value === 'objective' ? document.getElementById('linkedObjective').value : null,
                    createdAt: new Date().toISOString()
                };
                
                const existingIndex = this.calendarEvents.findIndex(e => e.id === event.id);
                if (existingIndex >= 0) {
                    this.calendarEvents[existingIndex] = event;
                    this.showNotification('Event updated successfully');
                } else {
                    this.calendarEvents.push(event);
                    this.showNotification('Event created successfully');
                }
                
                this.saveData();
                this.closeCalendarEventModal();
                this.renderFullCalendar();
                this.renderCalendarSection();
                this.renderDashboardCalendar();
            }

            editCalendarEvent(id) {
                this.openCalendarEventModal(id);
            }

            // Search Methods
            searchContent(query) {
                if (!query.trim()) {
                    this.updateUI();
                    return;
                }
                
                const searchLower = query.toLowerCase();
                const results = [];
                
                // Search in tasks
                const matchedTasks = this.tasks.filter(task => 
                    task.title.toLowerCase().includes(searchLower) ||
                    task.description?.toLowerCase().includes(searchLower)
                );
                matchedTasks.forEach(task => results.push({ type: 'task', item: task }));
                
                // Search in objectives
                const matchedObjectives = this.objectives.filter(obj => 
                    obj.title.toLowerCase().includes(searchLower) ||
                    obj.description?.toLowerCase().includes(searchLower)
                );
                matchedObjectives.forEach(obj => results.push({ type: 'objective', item: obj }));
                
                // Search in calendar events
                const matchedEvents = this.calendarEvents.filter(event => 
                    event.title.toLowerCase().includes(searchLower) ||
                    event.description?.toLowerCase().includes(searchLower)
                );
                matchedEvents.forEach(event => results.push({ type: 'event', item: event }));
                
                // Display search results
                this.displaySearchResults(results);
            }

            displaySearchResults(results) {
                const currentSection = document.querySelector('.content-section.active').id;
                let container;
                
                if (currentSection === 'dashboard' || currentSection === 'tasks') {
                    container = document.getElementById('todayTasks');
                } else if (currentSection === 'objectives') {
                    container = document.getElementById('objectivesList');
                } else if (currentSection === 'calendar') {
                    container = document.getElementById('calendarMonthView');
                } else {
                    return;
                }
                
                if (!container) return;
                
                if (results.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <h3>No results found</h3>
                            <p>Try different search terms</p>
                        </div>
                    `;
                } else {
                    let html = `<h3 class="font-bold mb-3">Search Results (${results.length})</h3>`;
                    
                    results.forEach(result => {
                        if (result.type === 'task') {
                            html += this.createTaskHtml(result.item);
                        } else if (result.type === 'objective') {
                            const obj = result.item;
                            html += `
                                <div class="objective-card card" data-objective-id="${obj.id}">
                                    <div class="card-header">
                                        <h3 class="card-title">${obj.title}</h3>
                                        <span class="status-badge status-${obj.status}">${obj.status.charAt(0).toUpperCase() + obj.status.slice(1)}</span>
                                    </div>
                                    <p class="text-muted">${obj.description || 'No description'}</p>
                                    <div class="mt-4">
                                        <div class="flex justify-between text-sm">
                                            <span><i class="fas fa-tag"></i> ${this.getCategoryText(obj.category)}</span>
                                            <span><i class="fas fa-flag"></i> ${this.getTimeRangeText(obj.timeRange)}</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        } else if (result.type === 'event') {
                            const event = result.item;
                            html += `
                                <div class="card mb-2">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="font-bold">${event.title}</h4>
                                            <p class="text-sm text-muted">${event.date} ${event.time ? 'at ' + event.time : ''}</p>
                                        </div>
                                        <span class="px-2 py-1 rounded text-xs" style="background: ${event.color}; color: white;">
                                            ${event.type}
                                        </span>
                                    </div>
                                </div>
                            `;
                        }
                    });
                    
                    container.innerHTML = html;
                }
            }

            // Objective Methods
            openObjectiveModal(objectiveId = null) {
                const modal = document.getElementById('objectiveModal');
                
                if (objectiveId) {
                    const objective = this.objectives.find(obj => obj.id === objectiveId);
                    if (objective) {
                        document.getElementById('objectiveModalTitle').textContent = 'Edit Objective';
                        document.getElementById('objectiveId').value = objective.id;
                        document.getElementById('objectiveTitle').value = objective.title;
                        document.getElementById('objectiveDescription').value = objective.description || '';
                        document.getElementById('objectiveCategory').value = objective.category;
                        document.getElementById('objectiveTimeRange').value = objective.timeRange;
                        document.getElementById('objectivePriority').value = objective.priority;
                        document.getElementById('objectiveStatus').value = objective.status;
                        document.getElementById('objectiveDeadline').value = objective.deadline || '';
                    }
                } else {
                    document.getElementById('objectiveModalTitle').textContent = 'New Objective';
                    document.getElementById('objectiveForm').reset();
                    document.getElementById('objectiveId').value = '';
                    document.getElementById('objectiveDeadline').value = '';
                }
                
                modal.classList.add('active');
            }

            closeObjectiveModal() {
                document.getElementById('objectiveModal').classList.remove('active');
            }

            saveObjective(e) {
                e.preventDefault();
                
                const objective = {
                    id: document.getElementById('objectiveId').value || this.generateId(),
                    title: document.getElementById('objectiveTitle').value,
                    description: document.getElementById('objectiveDescription').value,
                    category: document.getElementById('objectiveCategory').value,
                    timeRange: document.getElementById('objectiveTimeRange').value,
                    priority: parseInt(document.getElementById('objectivePriority').value),
                    status: document.getElementById('objectiveStatus').value,
                    deadline: document.getElementById('objectiveDeadline').value || null,
                    createdAt: new Date().toISOString()
                };
                
                const existingIndex = this.objectives.findIndex(obj => obj.id === objective.id);
                if (existingIndex >= 0) {
                    this.objectives[existingIndex] = objective;
                    this.showNotification('Objective updated successfully');
                } else {
                    this.objectives.push(objective);
                    this.showNotification('Objective created successfully');
                    
                    if (!this.settings.activeObjective) {
                        this.setActiveObjective(objective.id);
                    }
                }
                
                this.saveData();
                this.closeObjectiveModal();
                this.updateUI();
            }

            editObjective(id) {
                this.openObjectiveModal(id);
            }

            changeActiveObjective() {
                if (this.objectives.length === 0) {
                    this.openObjectiveModal();
                    return;
                }
                
                let message = "Select an objective to set as active:\n\n";
                this.objectives.forEach((obj, index) => {
                    message += `${index + 1}. ${obj.title} (${obj.status})\n`;
                });
                
                const choice = prompt(message + "\nEnter the number of the objective:");
                if (choice && !isNaN(choice) && choice > 0 && choice <= this.objectives.length) {
                    this.setActiveObjective(this.objectives[choice - 1].id);
                }
            }

            setActiveObjective(id) {
                this.settings.activeObjective = id;
                this.saveData();
                this.updateUI();
                this.showNotification('Active objective updated');
            }

            deleteObjective(id) {
                if (confirm('Are you sure you want to delete this objective and all its tasks?')) {
                    this.objectives = this.objectives.filter(obj => obj.id !== id);
                    this.tasks = this.tasks.filter(task => task.objectiveId !== id);
                    
                    if (this.settings.activeObjective === id) {
                        this.settings.activeObjective = null;
                    }
                    
                    this.saveData();
                    this.updateUI();
                    this.showNotification('Objective deleted');
                }
            }

            // Task Methods
            openTaskModal(taskId = null) {
                const modal = document.getElementById('taskModal');
                const objectiveSelect = document.getElementById('taskObjective');
                objectiveSelect.innerHTML = '<option value="">Select objective</option>' +
                    this.objectives.map(obj => 
                        `<option value="${obj.id}">${obj.title}</option>`
                    ).join('');
                
                if (taskId) {
                    const task = this.tasks.find(t => t.id === taskId);
                    if (task) {
                        document.getElementById('taskModalTitle').textContent = 'Edit Task';
                        document.getElementById('taskId').value = task.id;
                        document.getElementById('taskTitle').value = task.title;
                        document.getElementById('taskDescription').value = task.description || '';
                        document.getElementById('taskObjective').value = task.objectiveId;
                        document.getElementById('taskDeadline').value = task.deadline;
                        document.getElementById('taskDuration').value = task.duration;
                        document.getElementById('taskImportance').value = task.importance;
                        document.getElementById('taskStatus').value = task.status;
                    }
                } else {
                    document.getElementById('taskModalTitle').textContent = 'New Task';
                    document.getElementById('taskForm').reset();
                    document.getElementById('taskId').value = '';
                    
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('taskDeadline').value = today;
                    
                    if (this.settings.activeObjective) {
                        document.getElementById('taskObjective').value = this.settings.activeObjective;
                    }
                }
                
                modal.classList.add('active');
            }

            closeTaskModal() {
                document.getElementById('taskModal').classList.remove('active');
            }

            saveTask(e) {
                e.preventDefault();
                
                const task = {
                    id: document.getElementById('taskId').value || this.generateId(),
                    title: document.getElementById('taskTitle').value,
                    description: document.getElementById('taskDescription').value,
                    objectiveId: document.getElementById('taskObjective').value,
                    deadline: document.getElementById('taskDeadline').value,
                    duration: parseFloat(document.getElementById('taskDuration').value),
                    importance: parseInt(document.getElementById('taskImportance').value),
                    status: document.getElementById('taskStatus').value,
                    createdAt: new Date().toISOString()
                };
                
                const existingIndex = this.tasks.findIndex(t => t.id === task.id);
                if (existingIndex >= 0) {
                    this.tasks[existingIndex] = task;
                    this.showNotification('Task updated successfully');
                } else {
                    this.tasks.push(task);
                    this.showNotification('Task created successfully');
                    
                    // Check for first task achievement
                    this.updateAchievements();
                }
                
                this.saveData();
                this.closeTaskModal();
                this.updateUI();
            }

            editTask(id) {
                this.openTaskModal(id);
            }

            deleteTask(id) {
                if (confirm('Are you sure you want to delete this task?')) {
                    this.tasks = this.tasks.filter(task => task.id !== id);
                    this.saveData();
                    this.updateUI();
                    this.showNotification('Task deleted');
                }
            }

            toggleTaskCompletion(id) {
                const task = this.tasks.find(t => t.id === id);
                if (task) {
                    if (task.status === 'completed') {
                        task.status = 'not-started';
                        this.settings.todayTasksCompleted = Math.max(0, (this.settings.todayTasksCompleted || 0) - 1);
                    } else {
                        task.status = 'completed';
                        this.settings.todayTasksCompleted = (this.settings.todayTasksCompleted || 0) + 1;
                        
                        // Check for first task achievement
                        this.updateAchievements();
                    }
                    this.saveData();
                    this.updateDashboard();
                }
            }

            duplicateItem(id, type) {
                if (type === 'task') {
                    const task = this.tasks.find(t => t.id === id);
                    if (task) {
                        const newTask = { ...task, id: this.generateId() };
                        this.tasks.push(newTask);
                        this.saveData();
                        this.updateUI();
                        this.showNotification('Task duplicated');
                    }
                } else {
                    const objective = this.objectives.find(obj => obj.id === id);
                    if (objective) {
                        const newObjective = { ...objective, id: this.generateId() };
                        this.objectives.push(newObjective);
                        this.saveData();
                        this.updateUI();
                        this.showNotification('Objective duplicated');
                    }
                }
            }

            // New Features
            generateReport() {
                const report = {
                    date: new Date().toISOString(),
                    totalObjectives: this.objectives.length,
                    completedObjectives: this.objectives.filter(obj => obj.status === 'completed').length,
                    totalTasks: this.tasks.length,
                    completedTasks: this.tasks.filter(task => task.status === 'completed').length,
                    totalFocusHours: this.settings.totalFocusHours,
                    streak: this.settings.streak,
                    efficiency: this.calculateEfficiencyScore(),
                    achievements: this.achievements.filter(a => a.unlocked).length,
                    weeklyGrowth: this.calculateWeeklyGrowth()
                };
                
                const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `focusflow-report-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Report generated successfully');
            }

            viewDayDetails(date) {
                const dayTasks = this.tasks.filter(task => task.deadline === date);
                const daySessions = this.settings.focusSessions.filter(session => session.date === date);
                const dayEvents = this.getEventsForDate(date);
                
                let message = `Activities for ${new Date(date).toLocaleDateString()}:\n\n`;
                message += `Tasks: ${dayTasks.length}\n`;
                message += `Events: ${dayEvents.length}\n`;
                message += `Focus Sessions: ${daySessions.length}\n`;
                message += `Total Focus Time: ${daySessions.reduce((sum, session) => sum + session.duration, 0).toFixed(1)} hours`;
                
                alert(message);
            }

            // Settings Methods
            editUserName() {
                const name = prompt('Enter your name:', this.settings.userName);
                if (name !== null && name.trim()) {
                    this.settings.userName = name.trim();
                    this.saveData();
                    this.updateSettingsUI();
                    this.updateDashboard();
                    this.showNotification('Name updated');
                }
            }

            editFocusArea() {
                const focus = prompt('Enter your focus area:', this.settings.userFocus);
                if (focus !== null) {
                    this.settings.userFocus = focus;
                    this.saveData();
                    this.updateSettingsUI();
                    this.updateDashboard();
                    this.showNotification('Focus area updated');
                }
            }

            editWorkStyle() {
                const style = prompt('Enter your work style (pomodoro, deep, timeblocking, flexible):', this.settings.workStyle);
                if (style !== null && ['pomodoro', 'deep', 'timeblocking', 'flexible'].includes(style.toLowerCase())) {
                    this.settings.workStyle = style.toLowerCase();
                    this.saveData();
                    this.updateSettingsUI();
                    this.showNotification('Work style updated');
                }
            }

            exportData() {
                const data = {
                    objectives: this.objectives,
                    tasks: this.tasks,
                    calendarEvents: this.calendarEvents,
                    settings: this.settings,
                    grindSettings: this.grindSettings,
                    timerSettings: this.timerSettings,
                    musicSettings: this.musicSettings,
                    achievements: this.achievements,
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `focusflow-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Data exported successfully');
            }

            importData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (confirm('This will replace all your current data. Continue?')) {
                                this.objectives = data.objectives || [];
                                this.tasks = data.tasks || [];
                                this.calendarEvents = data.calendarEvents || [];
                                this.settings = { ...this.settings, ...data.settings };
                                this.grindSettings = data.grindSettings || this.grindSettings;
                                this.timerSettings = data.timerSettings || this.timerSettings;
                                this.musicSettings = data.musicSettings || this.musicSettings;
                                this.achievements = data.achievements || this.achievements;
                                this.saveData();
                                this.updateUI();
                                this.showNotification('Data imported successfully');
                            }
                        } catch (error) {
                            alert('Invalid backup file');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            clearData() {
                if (confirm('This will delete ALL your data and reset the application. Are you sure?')) {
                    localStorage.clear();
                    this.init();
                    this.showNotification('All data cleared');
                }
            }

            // Utility Methods
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            getObjectiveProgress(objectiveId) {
                const objectiveTasks = this.tasks.filter(task => task.objectiveId === objectiveId);
                if (objectiveTasks.length === 0) return 0;
                
                const completedTasks = objectiveTasks.filter(task => task.status === 'completed').length;
                return Math.round((completedTasks / objectiveTasks.length) * 100);
            }

            getOverallProgress() {
                if (this.objectives.length === 0) return 0;
                
                const totalProgress = this.objectives.reduce((sum, obj) => {
                    return sum + this.getObjectiveProgress(obj.id);
                }, 0);
                
                return Math.round(totalProgress / this.objectives.length);
            }

            getCategoryText(category) {
                const categories = {
                    'academic': 'Academic',
                    'career': 'Career',
                    'personal': 'Personal',
                    'health': 'Health & Fitness',
                    'skill': 'Skill Development',
                    'creative': 'Creative'
                };
                return categories[category] || category;
            }

            getTimeRangeText(timeRange) {
                const ranges = {
                    'short': 'Short Term',
                    'medium': 'Medium Term',
                    'long': 'Long Term'
                };
                return ranges[timeRange] || timeRange;
            }

            getPriorityText(priority) {
                if (priority >= 4) return 'Critical';
                if (priority >= 3) return 'High';
                if (priority >= 2) return 'Medium';
                return 'Low';
            }

            getProgressMessage(progress) {
                if (progress === 0) return "Start your journey today!";
                if (progress < 25) return "Great start! Keep going!";
                if (progress < 50) return "Making steady progress!";
                if (progress < 75) return "Halfway there! Keep pushing!";
                if (progress < 100) return "Almost there! Finish strong!";
                return "All objectives completed! Amazing work!";
            }

            showTutorialTip() {
                const hasSeenTip = localStorage.getItem('focusFlow_tutorialSeen');
                if (!hasSeenTip) {
                    setTimeout(() => {
                        const tip = document.getElementById('tutorialTip');
                        const tipContent = document.getElementById('tipContent');
                        
                        const tips = [
                            "Try right-clicking on tasks and objectives for quick actions!",
                            "Use the quotes bar for daily motivation - click arrows to change quotes.",
                            "The grind zone has different backgrounds - click the palette icon to change.",
                            "Check your achievements by clicking on the achievement card!",
                            "You can now edit timer settings and switch between 12/24 hour formats!",
                            "Click on efficiency and growth cards to see detailed statistics.",
                            "Take regular breaks using the break feature for better productivity."
                        ];
                        
                        tipContent.textContent = tips[Math.floor(Math.random() * tips.length)];
                        tip.style.display = 'block';
                        
                        localStorage.setItem('focusFlow_tutorialSeen', 'true');
                    }, 3000);
                }
            }

            hideTip() {
                document.getElementById('tutorialTip').style.display = 'none';
            }

            showNotification(message) {
                const notification = document.getElementById('notification');
                document.getElementById('notificationMessage').textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            updateUI() {
                this.updateDashboard();
                this.renderObjectives();
                this.renderTasks();
                this.updateProgressStats();
                this.updateSettingsUI();
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            window.app = new FocusFlowApp();
        });
    </script>
</body>
</html>
